# UIãƒ»å…±æœ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ Source Code
Generated at: 2025-09-01
File count: 19 files
Purpose: UI components and shared utilities

================================================================================
FILE: src/app/games/[gameId]/edit/page.tsx
================================================================================

"use client";

import { use, useEffect, useState } from "react";
import { createClientComponentClient } from "@supabase/auth-helpers-nextjs";
import { useAuth } from "@/components/auth/AuthProvider";
import { useRouter } from "next/navigation";
import Link from "next/link";

interface Game {
  id: string;
  name: string;
  game_date: string;
  game_time: string | null;
  location: string | null;
  description: string | null;
  home_team_id: string | null;
  opponent_name: string;
  status: string;
  home_score: number;
  opponent_score: number;
  record_type: string;
  is_public: boolean;
  attendance_check_enabled: boolean;
  category?: "official" | "practice" | "scrimmage";
  created_by: string;
  created_at: string;
  updated_at: string;
}

interface Team {
  id: string;
  name: string;
}

interface PageProps {
  params: Promise<{
    gameId: string;
  }>;
}

export default function EditGamePage({ params }: PageProps) {
  const resolvedParams = use(params);
  const gameId = resolvedParams.gameId;

  const [game, setGame] = useState<Game | null>(null);
  const [teams, setTeams] = useState<Team[]>([]);
  const [gameName, setGameName] = useState("");
  const [gameDate, setGameDate] = useState("");
  const [gameTime, setGameTime] = useState("");
  const [location, setLocation] = useState("");
  const [description, setDescription] = useState("");
  const [selectedTeamId, setSelectedTeamId] = useState("");
  const [opponentName, setOpponentName] = useState("");
  const [status, setStatus] = useState("scheduled");
  const [recordType, setRecordType] = useState("team");
  const [isPublic, setIsPublic] = useState(true);
  const [attendanceCheckEnabled, setAttendanceCheckEnabled] = useState(false);
  const [category, setCategory] = useState<"official" | "practice" | "scrimmage">("practice");
  const [isMyTeamBatFirst, setIsMyTeamBatFirst] = useState<boolean | null>(null);
  const [loading, setLoading] = useState(true);
  const [saving, setSaving] = useState(false);
  const [error, setError] = useState("");
  const [canEdit, setCanEdit] = useState(false);

  const { user, loading: authLoading } = useAuth();
  const router = useRouter();
  const supabase = createClientComponentClient();

  useEffect(() => {

    if (authLoading) return;

    if (!user) {
      router.push("/login");
      return;
    }

    fetchGameAndTeams();
  }, [gameId, user, authLoading]);

  const fetchGameAndTeams = async () => {
    try {

      const { data: gameData, error: gameError } = await supabase
        .from("games")
        .select("*")
        .eq("id", gameId)
        .single();

      if (gameError) throw gameError;

      if (gameData) {
        setGame(gameData);
        setGameName(gameData.name);
        setGameDate(gameData.game_date);
        setGameTime(gameData.game_time || "");
        setLocation(gameData.location || "");
        setDescription(gameData.description || "");
        setSelectedTeamId(gameData.home_team_id || "");
        setOpponentName(gameData.opponent_name);
        setStatus(gameData.status);
        setRecordType(gameData.record_type);
        setIsPublic(gameData.is_public);
        setAttendanceCheckEnabled(gameData.attendance_check_enabled || false);
        setCategory(gameData.category || "practice");

const { data: scoreData } = await supabase
  .from("game_scores")
  .select("is_my_team_bat_first")
  .eq("game_id", gameId)
  .limit(1)
  .single();

if (scoreData) {
  setIsMyTeamBatFirst(scoreData.is_my_team_bat_first);
}

        if (user) {

          if (gameData.created_by === user.id) {
            setCanEdit(true);
          } else if (gameData.home_team_id) {

            const { data: member } = await supabase
              .from("team_members")
              .select("role")
              .eq("team_id", gameData.home_team_id)
              .eq("user_id", user.id)
              .single();

            if (member) {
              setCanEdit(true);
            }
          }
        }
      }

      if (user) {
        const { data: teamMembers, error: tmError } = await supabase
          .from("team_members")
          .select("team_id")
          .eq("user_id", user.id);

        if (tmError) throw tmError;

        if (teamMembers && teamMembers.length > 0) {
          const teamIds = teamMembers.map((tm) => tm.team_id);
          const { data: teamsData, error: teamsError } = await supabase
            .from("teams")
            .select("id, name")
            .in("id", teamIds);

          if (teamsError) throw teamsError;
          if (teamsData) {
            setTeams(teamsData);
          }
        }
      }
    } catch (err: any) {
      setError(err.message || "ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ");
    } finally {
      setLoading(false);
    }
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setSaving(true);
    setError("");

    try {
      const updateData: any = {
        name: gameName,
        game_date: gameDate,
        game_time: gameTime || null,
        location: location || null,
        description: description || null,
        home_team_id: selectedTeamId || null,
        opponent_name: opponentName,
        status: status,
        record_type: selectedTeamId ? "team" : "individual",
        is_public: isPublic,
        attendance_check_enabled: attendanceCheckEnabled,
        category: category,
        updated_at: new Date().toISOString(),
      };

if (isMyTeamBatFirst !== null) {
  await supabase
    .from("game_scores")
    .update({ is_my_team_bat_first: isMyTeamBatFirst })
    .eq("game_id", gameId);
}

      const { error } = await supabase
        .from("games")
        .update(updateData)
        .eq("id", gameId);

      if (error) throw error;

      if (
        attendanceCheckEnabled &&
        !game?.attendance_check_enabled &&
        selectedTeamId
      ) {

        const { data: teamMembers, error: tmError } = await supabase
          .from("team_members")
          .select("id")
          .eq("team_id", selectedTeamId);

        if (tmError) {
          console.error("ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼å–å¾—ã‚¨ãƒ©ãƒ¼:", tmError);
        } else if (teamMembers && teamMembers.length > 0) {

          const { data: existingAttendances } = await supabase
            .from("game_attendances")
            .select("team_member_id")
            .eq("game_id", gameId);

          const existingMemberIds =
            existingAttendances?.map((a) => a.team_member_id) || [];

          const newAttendanceRecords = teamMembers
            .filter((member) => !existingMemberIds.includes(member.id))
            .map((member) => ({
              game_id: gameId,
              team_member_id: member.id,
              status: "pending",
            }));

          if (newAttendanceRecords.length > 0) {
            const { error: attendanceError } = await supabase
              .from("game_attendances")
              .insert(newAttendanceRecords);

            if (attendanceError) {
              console.error("å‡ºæ¬ ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆã‚¨ãƒ©ãƒ¼:", attendanceError);
            }
          }
        }
      }

      router.push(`/games/${gameId}`);
    } catch (err: any) {
      setError(err.message || "è©¦åˆã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ");
    } finally {
      setSaving(false);
    }
  };

  if (loading) {
    return (
      <div className="min-h-screen bg-gray-50 flex items-center justify-center">
        <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div>
      </div>
    );
  }

  if (!canEdit) {
    return (
      <div className="min-h-screen bg-gray-50 py-8">
        <div className="max-w-3xl mx-auto px-4">
          <div className="bg-white rounded-lg shadow p-6">
            <p className="text-red-600">ã“ã®è©¦åˆã‚’ç·¨é›†ã™ã‚‹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“</p>
            <Link
              href={`/games/${gameId}`}
              className="mt-4 inline-block text-blue-600 hover:text-blue-700"
            >
              è©¦åˆè©³ç´°ã«æˆ»ã‚‹
            </Link>
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-gray-50 py-8">
      <div className="max-w-3xl mx-auto px-4">
        <div className="bg-white rounded-lg shadow p-6">
          <div className="flex items-center justify-between mb-6">
            <h1 className="text-2xl font-bold">è©¦åˆç·¨é›†</h1>
            <Link
              href={`/games/${gameId}`}
              className="text-gray-600 hover:text-gray-900"
            >
              â† æˆ»ã‚‹
            </Link>
          </div>

          <form onSubmit={handleSubmit} className="space-y-6">
            {error && (
              <div className="bg-red-50 text-red-600 p-3 rounded-lg">
                {error}
              </div>
            )}

            {}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                è©¦åˆå *
              </label>
              <input
                type="text"
                value={gameName}
                onChange={(e) => setGameName(e.target.value)}
                required
                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
            </div>

            {}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                è©¦åˆæ—¥ *
              </label>
              <input
                type="date"
                value={gameDate}
                onChange={(e) => setGameDate(e.target.value)}
                required
                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
            </div>

            {}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                é–‹å§‹æ™‚é–“
              </label>
              <input
                type="time"
                value={gameTime}
                onChange={(e) => setGameTime(e.target.value)}
                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
            </div>

            {}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                å ´æ‰€
              </label>
              <input
                type="text"
                value={location}
                onChange={(e) => setLocation(e.target.value)}
                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
            </div>

            {}
            {teams.length > 0 && (
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  ãƒãƒ¼ãƒ 
                </label>
                <select
                  value={selectedTeamId}
                  onChange={(e) => setSelectedTeamId(e.target.value)}
                  className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                >
                  <option value="">å€‹äººè¨˜éŒ²ã¨ã—ã¦ä½œæˆ</option>
                  {teams.map((team) => (
                    <option key={team.id} value={team.id}>
                      {team.name}
                    </option>
                  ))}
                </select>
              </div>
            )}

            {}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                å¯¾æˆ¦ç›¸æ‰‹
              </label>
              <input
                type="text"
                value={opponentName}
                onChange={(e) => setOpponentName(e.target.value)}
                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
            </div>

            {}
<div>
  <label className="block text-sm font-medium text-gray-700 mb-2">
    è©¦åˆã‚«ãƒ†ã‚´ãƒªãƒ¼
  </label>
  <select
    value={category}
    onChange={(e) => setCategory(e.target.value as "official" | "practice" | "scrimmage")}
    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
  >
    <option value="official">å…¬å¼æˆ¦</option>
    <option value="practice">ç·´ç¿’è©¦åˆ</option>
    <option value="scrimmage">ç´…ç™½æˆ¦</option>
  </select>
</div>

{}
<div>
  <label className="block text-sm font-medium text-gray-700 mb-2">
    å…ˆæ”»/å¾Œæ”»
  </label>
  <div className="flex space-x-4">
    <button
      type="button"
      onClick={() => setIsMyTeamBatFirst(true)}
      className={`py-2 px-4 rounded-lg border-2 font-medium transition-colors ${
        isMyTeamBatFirst === true
          ? "border-blue-600 bg-blue-50 text-blue-700"
          : "border-gray-300 hover:border-gray-400"
      }`}
    >
      å…ˆæ”»ï¼ˆè¡¨ã®æ”»æ’ƒï¼‰
    </button>
    <button
      type="button"
      onClick={() => setIsMyTeamBatFirst(false)}
      className={`py-2 px-4 rounded-lg border-2 font-medium transition-colors ${
        isMyTeamBatFirst === false
          ? "border-green-600 bg-green-50 text-green-700"
          : "border-gray-300 hover:border-gray-400"
      }`}
    >
      å¾Œæ”»ï¼ˆè£ã®æ”»æ’ƒï¼‰
    </button>
  </div>
  <p className="mt-2 text-sm text-gray-500">
    è¨­å®šã¯ä»»æ„ã§ã™ã€‚ã‚¹ã‚³ã‚¢å…¥åŠ›æ™‚ã«ã‚‚å¤‰æ›´ã§ãã¾ã™ã€‚
  </p>
</div>

{}
<div>
  <label className="block text-sm font-medium text-gray-700 mb-2">
    è©¦åˆã‚«ãƒ†ã‚´ãƒªãƒ¼
  </label>
  <select
    value={category}
    onChange={(e) => setCategory(e.target.value as "official" | "practice" | "scrimmage")}
    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
  >
    <option value="official">å…¬å¼æˆ¦</option>
    <option value="practice">ç·´ç¿’è©¦åˆ</option>
    <option value="scrimmage">ç´…ç™½æˆ¦</option>
  </select>
</div>

            {}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
              </label>
              <select
                value={status}
                onChange={(e) => setStatus(e.target.value)}
                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              >
                <option value="scheduled">äºˆå®š</option>
                <option value="in_progress">é€²è¡Œä¸­</option>
                <option value="completed">å®Œäº†</option>
                <option value="cancelled">ä¸­æ­¢</option>
              </select>
            </div>

            {}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                èª¬æ˜
              </label>
              <textarea
                value={description}
                onChange={(e) => setDescription(e.target.value)}
                rows={3}
                className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
            </div>

            {}
            {selectedTeamId && (
              <div className="border-t pt-4">
                <label className="flex items-center space-x-3 cursor-pointer">
                  <input
                    type="checkbox"
                    checked={attendanceCheckEnabled}
                    onChange={(e) =>
                      setAttendanceCheckEnabled(e.target.checked)
                    }
                    className="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
                  />
                  <div>
                    <span className="text-sm font-medium text-gray-700">
                      å‡ºæ¬ ç¢ºèªã‚’æœ‰åŠ¹ã«ã™ã‚‹
                    </span>
                    <p className="text-xs text-gray-500 mt-1">
                      ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ã«å‡ºæ¬ ç¢ºèªã‚’æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™
                    </p>
                    {game?.attendance_check_enabled &&
                      !attendanceCheckEnabled && (
                        <p className="text-xs text-orange-600 mt-1">
                          âš ï¸
                          å‡ºæ¬ ç¢ºèªã‚’ç„¡åŠ¹ã«ã—ã¦ã‚‚ã€æ—¢å­˜ã®å›ç­”ãƒ‡ãƒ¼ã‚¿ã¯ä¿æŒã•ã‚Œã¾ã™
                        </p>
                      )}
                  </div>
                </label>
              </div>
            )}

            {}
            <div>
              <label className="flex items-center space-x-3">
                <input
                  type="checkbox"
                  checked={isPublic}
                  onChange={(e) => setIsPublic(e.target.checked)}
                  className="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
                />
                <span className="text-sm font-medium text-gray-700">
                  ã“ã®è©¦åˆã‚’å…¬é–‹ã™ã‚‹
                </span>
              </label>
            </div>

            {}
            <div className="flex justify-end space-x-4">
              <Link
                href={`/games/${gameId}`}
                className="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50"
              >
                ã‚­ãƒ£ãƒ³ã‚»ãƒ«
              </Link>
              <button
                type="submit"
                disabled={saving}
                className="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50"
              >
                {saving ? "ä¿å­˜ä¸­..." : "å¤‰æ›´ã‚’ä¿å­˜"}
              </button>
            </div>
          </form>

          {}
          <div className="mt-8 pt-8 border-t">
            <h3 className="text-sm font-medium text-gray-700 mb-2">è©¦åˆæƒ…å ±</h3>
            <dl className="text-sm space-y-1 text-gray-600">
              <div className="flex">
                <dt className="w-24">ä½œæˆæ—¥:</dt>
                <dd>{new Date(game.created_at).toLocaleDateString("ja-JP")}</dd>
              </div>
              <div className="flex">
                <dt className="w-24">æ›´æ–°æ—¥:</dt>
                <dd>{new Date(game.updated_at).toLocaleDateString("ja-JP")}</dd>
              </div>
              {game.status === "completed" && (
                <div className="flex">
                  <dt className="w-24">ã‚¹ã‚³ã‚¢:</dt>
                  <dd>
                    {game.home_score} - {game.opponent_score}
                  </dd>
                </div>
              )}
            </dl>
          </div>
        </div>
      </div>
    </div>
  );
}


================================================================================
FILE: src/app/games/[gameId]/operations/page.tsx
================================================================================

"use client";

import { use, useEffect, useState } from "react";
import { createClientComponentClient } from "@supabase/auth-helpers-nextjs";
import { useAuth } from "@/components/auth/AuthProvider";
import { useRouter } from "next/navigation";
import Link from "next/link";

interface TeamMember {
  id: string;
  user_id: string;
  user_profiles?: {
    display_name: string | null;
  };
}

interface OperationTask {
  id?: string;
  game_id: string;
  task_type: string;
  person_name: string;
  team_member_id: string | null;
}

interface Game {
  id: string;
  name: string;
  game_date: string;
  home_team_id: string;
}

const TASK_TYPES = [
  { value: "equipment", label: "ç”¨å…·ã®ä¿ç®¡ãƒ»é‹æ¬", icon: "ğŸ’" },
  { value: "scheduling", label: "è©¦åˆã‚’çµ„ã‚€", icon: "ğŸ“…" },
  { value: "coordination", label: "å¯¾æˆ¦ç›¸æ‰‹ã¨ã®èª¿æ•´", icon: "ğŸ¤" },
  { value: "ground", label: "ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚’ç”¨æ„", icon: "ğŸŸï¸" },
  { value: "attendance", label: "å‡ºæ¬ ã‚’å–ã‚‹", icon: "ğŸ“‹" },
  { value: "umpire", label: "å¯©åˆ¤ã®æ‰‹é…", icon: "âš¾" },
  { value: "helper", label: "åŠ©ã£äººã®æ‰‹é…", icon: "ğŸ‘¥" },
  { value: "media", label: "å†™çœŸãƒ»å‹•ç”»æ’®å½±", icon: "ğŸ“¸" },
  { value: "accounting", label: "ä¼šè¨ˆå ±å‘Š", icon: "ğŸ’°" },
];

interface PageProps {
  params: Promise<{
    gameId: string;
  }>;
}

export default function GameOperationsPage({ params }: PageProps) {
  const resolvedParams = use(params);
  const gameId = resolvedParams.gameId;

  const [game, setGame] = useState<Game | null>(null);
  const [teamMembers, setTeamMembers] = useState<TeamMember[]>([]);
  const [tasks, setTasks] = useState<OperationTask[]>([]);
  const [loading, setLoading] = useState(true);
  const [saving, setSaving] = useState(false);
  const [selectedTasks, setSelectedTasks] = useState<{
    [key: string]: { memberType: "member" | "text"; value: string };
  }>({});
  const { user, loading: authLoading } = useAuth();
  const router = useRouter();
  const supabase = createClientComponentClient();

  useEffect(() => {

    if (authLoading) return;

    if (!user) {
      router.push("/login");
      return;
    }

    fetchData();
  }, [gameId, user, authLoading]);

  const fetchData = async () => {
    try {

      const { data: gameData, error: gameError } = await supabase
        .from("games")
        .select("*")
        .eq("id", gameId)
        .single();

      if (gameError || !gameData) {
        console.error("è©¦åˆå–å¾—ã‚¨ãƒ©ãƒ¼:", gameError);
        router.push("/games");
        return;
      }

      setGame(gameData);

      const { data: membersData, error: membersError } = await supabase
        .from("team_members")
        .select("id, user_id")
        .eq("team_id", gameData.home_team_id);

      if (membersData) {

        const userIds = membersData.map((m) => m.user_id);
        const { data: profilesData } = await supabase
          .from("user_profiles")
          .select("id, display_name")
          .in("id", userIds);

        const profileMap = new Map(profilesData?.map((p) => [p.id, p]) || []);

        const membersWithProfiles = membersData.map((member) => ({
          ...member,
          user_profiles: profileMap.get(member.user_id) || {
            display_name: null,
          },
        }));

        setTeamMembers(membersWithProfiles);
      }

      const { data: tasksData, error: tasksError } = await supabase
        .from("game_operation_tasks")
        .select("*")
        .eq("game_id", gameId);

      if (tasksData) {
        setTasks(tasksData);

        const selected: {
          [key: string]: { memberType: "member" | "text"; value: string };
        } = {};
        tasksData.forEach((task) => {
          selected[task.task_type] = {
            memberType: task.team_member_id ? "member" : "text",
            value: task.team_member_id || task.person_name,
          };
        });
        setSelectedTasks(selected);
      }
    } catch (error) {
      console.error("ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼:", error);
    } finally {
      setLoading(false);
    }
  };

  const handleTaskChange = (
    taskType: string,
    memberType: "member" | "text",
    value: string
  ) => {
    setSelectedTasks((prev) => ({
      ...prev,
      [taskType]: { memberType, value },
    }));
  };

  const handleSave = async () => {
    if (!user || !game) return;

    setSaving(true);
    try {

      const { error: deleteError } = await supabase
        .from("game_operation_tasks")
        .delete()
        .eq("game_id", gameId);

      if (deleteError) {
        console.error("å‰Šé™¤ã‚¨ãƒ©ãƒ¼:", deleteError);
        alert("ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ");
        return;
      }

      const newTasks: OperationTask[] = [];

      for (const [taskType, selection] of Object.entries(selectedTasks)) {
        if (selection.value) {
          let personName = "";
          let teamMemberId: string | null = null;

          if (selection.memberType === "member") {

            teamMemberId = selection.value;
            const member = teamMembers.find((m) => m.id === selection.value);
            personName = member?.user_profiles?.display_name || "åå‰æœªè¨­å®š";
          } else {

            personName = selection.value;
          }

          newTasks.push({
            game_id: gameId,
            task_type: taskType,
            person_name: personName,
            team_member_id: teamMemberId,
          });
        }
      }

      if (newTasks.length > 0) {
        const { error: insertError } = await supabase
          .from("game_operation_tasks")
          .insert(newTasks);

        if (insertError) {
          console.error("æŒ¿å…¥ã‚¨ãƒ©ãƒ¼:", insertError);
          alert("ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ");
          return;
        }
      }

      alert("ä¿å­˜ã—ã¾ã—ãŸï¼");
      router.push(`/games/${gameId}`);
    } catch (error) {
      console.error("ä¿å­˜ã‚¨ãƒ©ãƒ¼:", error);
      alert("ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ");
    } finally {
      setSaving(false);
    }
  };

  if (loading) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div>
      </div>
    );
  }

  if (!game) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <p className="text-gray-600">è©¦åˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</p>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-gray-50 py-8">
      <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        {}
        <div className="mb-6">
          <Link
            href={`/games/${gameId}`}
            className="inline-flex items-center text-gray-600 hover:text-gray-900 mb-4"
          >
            <svg
              className="w-5 h-5 mr-2"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                strokeLinecap="round"
                strokeLinejoin="round"
                strokeWidth={2}
                d="M15 19l-7-7 7-7"
              />
            </svg>
            è©¦åˆè©³ç´°ã«æˆ»ã‚‹
          </Link>

          <h1 className="text-3xl font-bold text-gray-900 mb-2">
            é‹å–¶ã‚¿ã‚¹ã‚¯ç®¡ç†
          </h1>
          <p className="text-gray-600">
            {game.name} - {new Date(game.game_date).toLocaleDateString("ja-JP")}
          </p>
        </div>

        {}
        <div className="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
          <p className="text-sm text-blue-800">
            ğŸ™ è©¦åˆé‹å–¶ã«ã”å”åŠ›ã„ãŸã ã„ãŸæ–¹ã€…ã‚’ç™»éŒ²ã—ã¾ã—ã‚‡ã†ã€‚
            ã¿ã‚“ãªãŒé‡çƒã‚’æ¥½ã—ã‚ã‚‹ã®ã¯ã€ã“ã‚Œã‚‰ã®ã‚¿ã‚¹ã‚¯ã‚’æ‹…å½“ã—ã¦ãã‚Œã‚‹æ–¹ã€…ã®ãŠã‹ã’ã§ã™ã€‚
          </p>
        </div>

        {}
        <div className="bg-white rounded-lg shadow">
          <div className="px-6 py-4 border-b">
            <h2 className="text-lg font-semibold text-gray-900">
              é‹å–¶ã‚¿ã‚¹ã‚¯ä¸€è¦§
            </h2>
          </div>
          <div className="p-6 space-y-6">
            {TASK_TYPES.map((task) => {
              const selected = selectedTasks[task.value] || {
                memberType: "member",
                value: "",
              };

              return (
                <div key={task.value} className="border-b pb-4 last:border-b-0">
                  <div className="flex items-start">
                    <span className="text-2xl mr-3 mt-1">{task.icon}</span>
                    <div className="flex-1">
                      <label className="block text-sm font-medium text-gray-700 mb-2">
                        {task.label}
                      </label>
                      <div className="flex items-center space-x-2 mb-2">
                        <label className="inline-flex items-center">
                          <input
                            type="radio"
                            name={`${task.value}_type`}
                            value="member"
                            checked={selected.memberType === "member"}
                            onChange={() =>
                              handleTaskChange(task.value, "member", "")
                            }
                            className="form-radio h-4 w-4 text-blue-600"
                          />
                          <span className="ml-2 text-sm text-gray-700">
                            ãƒ¡ãƒ³ãƒãƒ¼ã‹ã‚‰é¸æŠ
                          </span>
                        </label>
                        <label className="inline-flex items-center">
                          <input
                            type="radio"
                            name={`${task.value}_type`}
                            value="text"
                            checked={selected.memberType === "text"}
                            onChange={() =>
                              handleTaskChange(task.value, "text", "")
                            }
                            className="form-radio h-4 w-4 text-blue-600"
                          />
                          <span className="ml-2 text-sm text-gray-700">
                            åå‰ã‚’å…¥åŠ›
                          </span>
                        </label>
                      </div>

                      {selected.memberType === "member" ? (
                        <select
                          value={selected.value}
                          onChange={(e) =>
                            handleTaskChange(
                              task.value,
                              "member",
                              e.target.value
                            )
                          }
                          className="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        >
                          <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                          {teamMembers.map((member) => (
                            <option key={member.id} value={member.id}>
                              {member.user_profiles?.display_name ||
                                "åå‰æœªè¨­å®š"}
                            </option>
                          ))}
                        </select>
                      ) : (
                        <input
                          type="text"
                          value={selected.value}
                          onChange={(e) =>
                            handleTaskChange(task.value, "text", e.target.value)
                          }
                          placeholder="æ‹…å½“è€…ã®åå‰ã‚’å…¥åŠ›"
                          className="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        />
                      )}
                    </div>
                  </div>
                </div>
              );
            })}
          </div>
        </div>

        {}
        <div className="mt-6 flex justify-end space-x-4">
          <Link
            href={`/games/${gameId}`}
            className="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"
          >
            ã‚­ãƒ£ãƒ³ã‚»ãƒ«
          </Link>
          <button
            onClick={handleSave}
            disabled={saving}
            className="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400"
          >
            {saving ? "ä¿å­˜ä¸­..." : "ä¿å­˜ã™ã‚‹"}
          </button>
        </div>
      </div>
    </div>
  );
}


================================================================================
FILE: src/app/games/[gameId]/page.tsx
================================================================================

"use client";

import { use, useEffect, useState } from "react";
import { createClientComponentClient } from "@supabase/auth-helpers-nextjs";
import { useAuth } from "@/components/auth/AuthProvider";
import { useRouter, useSearchParams } from "next/navigation";
import Link from "next/link";
import OperationTasksDisplay from "@/components/game/OperationTasksDisplay";
import InlineScoreInput from "@/components/game/InlineScoreInput";
import ScoreBoxDisplay from "@/components/game/ScoreBoxDisplay";

interface Game {
  id: string;
  name: string;
  game_date: string;
  game_time: string | null;
  location: string | null;
  description: string | null;
  home_team_id: string | null;
  opponent_name: string;
  status: string;
  home_score: number;
  opponent_score: number;
  record_type: string;
  is_public: boolean;
  attendance_check_enabled: boolean;
  created_by: string;
  created_at: string;
  updated_at: string;
  category?: "official" | "practice" | "scrimmage";
}

interface Team {
  id: string;
  name: string;
}

interface GamePlayer {
  id: string;
  game_id: string;
  player_name: string;
  team_member_id: string | null;
  is_starter: boolean;
  batting_order: number | null;
  position: string | null;
  is_active: boolean;
}

interface GameAttendance {
  id: string;
  game_id: string;
  team_member_id: string | null;
  person_name: string | null;
  status: "pending" | "attending" | "absent";
  responded_at: string | null;
  team_member?: {

    id: string;
    user_id: string;
    user_profiles: {
      display_name: string | null;
    } | null;
  };
}

export default function GameDetailPage({
  params,
}: {
  params: Promise<{ gameId: string }>;
}) {
  const { gameId } = use(params);
  const router = useRouter();
  const searchParams = useSearchParams();
  const [game, setGame] = useState<Game | null>(null);
  const [team, setTeam] = useState<Team | null>(null);
  const [gamePlayers, setGamePlayers] = useState<GamePlayer[]>([]);
  const [loading, setLoading] = useState(true);
  const [canEdit, setCanEdit] = useState(false);
  const [isTeamMember, setIsTeamMember] = useState(false);
  const [attendances, setAttendances] = useState<GameAttendance[]>([]);
  const [currentUserAttendance, setCurrentUserAttendance] =
    useState<GameAttendance | null>(null);
  const [updatingAttendance, setUpdatingAttendance] = useState<string | null>(
    null
  );
  const [guestName, setGuestName] = useState("");
  const [addingGuest, setAddingGuest] = useState(false);

  const { user, loading: authLoading } = useAuth();
  const supabase = createClientComponentClient();

  const getBackLink = () => {
    const from = searchParams.get("from");

    if (from === "search") {
      return { href: "/search/games", label: "æ¤œç´¢çµæœã«æˆ»ã‚‹" };
    } else if (from === "team") {
      const teamId = searchParams.get("teamId");
      if (teamId) {
        return { href: `/teams/${teamId}`, label: "ãƒãƒ¼ãƒ è©³ç´°ã«æˆ»ã‚‹" };
      }
    } else if (from === "management") {
      return { href: "/games", label: "è©¦åˆç®¡ç†ã«æˆ»ã‚‹" };
    }

    return { href: "/dashboard", label: "ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«æˆ»ã‚‹" };
  };

  const backLink = getBackLink();

  useEffect(() => {

    if (authLoading) return;

    fetchGameData();
  }, [gameId, user, authLoading]);

  const fetchGameData = async () => {
    try {

      const { data: gameData, error: gameError } = await supabase
        .from("games")
        .select("*")
        .eq("id", gameId)
        .single();

      if (gameError) throw gameError;

      if (!user && gameData.status !== "completed") {
        router.push("/login");
        return;
      }

      setGame(gameData);

      if (gameData.home_team_id) {
        const { data: teamData, error: teamError } = await supabase
          .from("teams")
          .select("*")
          .eq("id", gameData.home_team_id)
          .single();

        if (!teamError && teamData) {
          setTeam(teamData);
        }

        if (user) {
          let userIsTeamMember = false;

          if (gameData.created_by === user.id) {
            setCanEdit(true);
            setIsTeamMember(true);
            userIsTeamMember = true;
          } else {

            const { data: memberData } = await supabase
              .from("team_members")
              .select("*")
              .eq("team_id", gameData.home_team_id)
              .eq("user_id", user.id)
              .single();

            if (memberData) {
              setCanEdit(true);
              setIsTeamMember(true);
              userIsTeamMember = true;
            }
          }

          if (
            userIsTeamMember &&
            gameData.attendance_check_enabled &&
            gameData.home_team_id
          ) {

            const { data: attendanceData, error: attendanceError } =
              await supabase
                .from("game_attendances")
                .select(
                  `
                *,
                team_member:team_members!game_attendances_team_member_id_fkey (
                  id,
                  user_id
                )
              `
                )
                .eq("game_id", gameId);

            console.log("Attendance data:", attendanceData);
            console.log("Attendance error:", attendanceError);

            if (
              !attendanceError &&
              attendanceData &&
              attendanceData.length > 0
            ) {

              const userIds = attendanceData
                .map((a: any) => a.team_member?.user_id)
                .filter((id: string) => id);

              const { data: profilesData } = await supabase
                .from("user_profiles")
                .select("id, display_name")
                .in("id", userIds);

              console.log("Profiles data:", profilesData);

              const attendanceWithProfiles = attendanceData.map(
                (attendance: any) => {
                  const profile = profilesData?.find(
                    (p) => p.id === attendance.team_member?.user_id
                  );
                  return {
                    ...attendance,
                    team_member: {
                      ...attendance.team_member,
                      user_profiles: profile || null,
                    },
                  };
                }
              );

              const sortedAttendanceData = attendanceWithProfiles.sort(
                (a: any, b: any) => {
                  const nameA =
                    a.team_member?.user_profiles?.display_name || "åå‰æœªè¨­å®š";
                  const nameB =
                    b.team_member?.user_profiles?.display_name || "åå‰æœªè¨­å®š";
                  return nameA.localeCompare(nameB, "ja");
                }
              );

              console.log(
                "Final attendance data with profiles:",
                sortedAttendanceData
              );

              setAttendances(sortedAttendanceData as GameAttendance[]);

              const currentUserData = sortedAttendanceData.find(
                (a: any) => a.team_member?.user_id === user?.id
              );
              console.log("Current user attendance:", currentUserData);
              setCurrentUserAttendance(currentUserData || null);
            } else {
              console.log("å‡ºæ¬ ãƒ‡ãƒ¼ã‚¿å–å¾—å¤±æ•—ã¾ãŸã¯ãƒ‡ãƒ¼ã‚¿ãªã—");

              if (
                !attendanceError &&
                attendanceData &&
                attendanceData.length === 0
              ) {
                console.log("å‡ºæ¬ ãƒ‡ãƒ¼ã‚¿ãŒç©ºã§ã™");
                setAttendances([]);
                setCurrentUserAttendance(null);
              }
            }
          }
        }
      } else {

        if (user && gameData.created_by === user.id) {
          setCanEdit(true);
        }
      }

      const { data: playersData, error: playersError } = await supabase
        .from("game_players")
        .select("*")
        .eq("game_id", gameId)
        .order("batting_order", { ascending: true });

      console.log("=== game_playerså–å¾—çµæœ ===");
      console.log("playersError:", playersError);
      console.log("playersData:", playersData);
      console.log("gameId:", gameId);
      console.log("user:", user);

      if (playersError) {
        console.error("å‚åŠ ãƒ¡ãƒ³ãƒãƒ¼å–å¾—ã‚¨ãƒ©ãƒ¼è©³ç´°:", playersError);
        setGamePlayers([]);
      } else {
        console.log("è¨­å®šã™ã‚‹playersData:", playersData || []);
        setGamePlayers(playersData || []);
      }
    } catch (error) {
      console.error("ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼:", error);
    } finally {
      setLoading(false);
    }
  };

  const initializeAttendanceRecords = async () => {
    if (!user || !game?.home_team_id) return;

    try {

      const { data: teamMembers, error: membersError } = await supabase
        .from("team_members")
        .select("id, user_id")
        .eq("team_id", game.home_team_id);

      if (membersError) {
        console.error("ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼å–å¾—ã‚¨ãƒ©ãƒ¼:", membersError);
        alert("ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ");
        return;
      }

      console.log("ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼:", teamMembers);

      const { data: existingAttendances, error: existingError } = await supabase
        .from("game_attendances")
        .select("team_member_id")
        .eq("game_id", gameId);

      if (existingError) {
        console.error("æ—¢å­˜å‡ºæ¬ ç¢ºèªã‚¨ãƒ©ãƒ¼:", existingError);
        alert("æ—¢å­˜ã®å‡ºæ¬ ç¢ºèªã®ç¢ºèªã«å¤±æ•—ã—ã¾ã—ãŸ");
        return;
      }

      console.log("æ—¢å­˜ã®å‡ºæ¬ ãƒ¬ã‚³ãƒ¼ãƒ‰:", existingAttendances);

      const existingMemberIds = new Set(
        existingAttendances?.map((a) => a.team_member_id) || []
      );

      const newMembers = teamMembers.filter(
        (member) => !existingMemberIds.has(member.id)
      );

      console.log("æ–°è¦è¿½åŠ ãƒ¡ãƒ³ãƒãƒ¼:", newMembers);

      if (newMembers.length === 0) {
        alert("ã™ã¹ã¦ã®ãƒ¡ãƒ³ãƒãƒ¼ã®å‡ºæ¬ ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒæ—¢ã«å­˜åœ¨ã—ã¾ã™");

        await fetchGameData();
        return;
      }

      const attendanceRecords = newMembers.map((member) => ({
        game_id: gameId,
        team_member_id: member.id,
        status: "pending" as const,
      }));

      console.log("ä½œæˆã™ã‚‹å‡ºæ¬ ãƒ¬ã‚³ãƒ¼ãƒ‰:", attendanceRecords);

      const { data: insertedData, error: insertError } = await supabase
        .from("game_attendances")
        .insert(attendanceRecords)
        .select();

      if (insertError) {
        console.error("å‡ºæ¬ ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆã‚¨ãƒ©ãƒ¼è©³ç´°:", {
          message: insertError.message,
          details: insertError.details,
          hint: insertError.hint,
          code: insertError.code,
          fullError: insertError,
        });

        if (insertError.code === "42501") {
          alert("æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚");
        } else if (insertError.code === "23505") {
          alert("æ—¢ã«å‡ºæ¬ ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒå­˜åœ¨ã—ã¾ã™ã€‚");
        } else {
          alert(`å‡ºæ¬ ç¢ºèªã®åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸ: ${insertError.message}`);
        }
        return;
      }

      console.log("å‡ºæ¬ ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆæˆåŠŸ:", insertedData);

      alert("å‡ºæ¬ ç¢ºèªã‚’é–‹å§‹ã—ã¾ã—ãŸ");
      await fetchGameData();
    } catch (error) {
      console.error("äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼:", error);
      alert("å‡ºæ¬ ç¢ºèªã®åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸ");
    }
  };

  const handleAttendanceUpdate = async (
    attendanceId: string,
    newStatus: "attending" | "absent"
  ) => {
    if (!user) return;

    setUpdatingAttendance(attendanceId);

    try {
      const { error } = await supabase
        .from("game_attendances")
        .update({
          status: newStatus,
          responded_at: new Date().toISOString(),
          updated_at: new Date().toISOString(),
        })
        .eq("id", attendanceId);

      if (error) throw error;

      setAttendances((prev) =>
        prev.map((a) =>
          a.id === attendanceId
            ? {
                ...a,
                status: newStatus,
                responded_at: new Date().toISOString(),
              }
            : a
        )
      );

      if (currentUserAttendance?.id === attendanceId) {
        setCurrentUserAttendance({
          ...currentUserAttendance,
          status: newStatus,
          responded_at: new Date().toISOString(),
        });
      }
    } catch (error) {
      console.error("å‡ºæ¬ æ›´æ–°ã‚¨ãƒ©ãƒ¼:", error);
      alert("å‡ºæ¬ ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ");
    } finally {
      setUpdatingAttendance(null);
    }
  };

  const addGuestAttendance = async () => {
    if (!guestName.trim()) {
      alert("åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
      return;
    }

    setAddingGuest(true);

    try {
      const { data, error } = await supabase
        .from("game_attendances")
        .insert({
          game_id: gameId,
          person_name: guestName.trim(),
          status: "attending",
          responded_at: new Date().toISOString(),
        })
        .select()
        .single();

      if (error) throw error;

      const newAttendance: GameAttendance = {
        ...data,
        team_member: undefined,
      };

      setAttendances((prev) => [...prev, newAttendance]);
      setGuestName("");
      alert(`${guestName}ã•ã‚“ã‚’å‡ºå¸­è€…ã¨ã—ã¦è¿½åŠ ã—ã¾ã—ãŸ`);
    } catch (error) {
      console.error("ã‚²ã‚¹ãƒˆè¿½åŠ ã‚¨ãƒ©ãƒ¼:", error);
      alert("ã‚²ã‚¹ãƒˆã®è¿½åŠ ã«å¤±æ•—ã—ã¾ã—ãŸ");
    } finally {
      setAddingGuest(false);
    }
  };

  const handleDelete = async () => {
    if (!confirm("æœ¬å½“ã«ã“ã®è©¦åˆã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ")) return;

    try {
      const { error } = await supabase.from("games").delete().eq("id", gameId);

      if (error) throw error;

      alert("è©¦åˆã‚’å‰Šé™¤ã—ã¾ã—ãŸ");
      router.push(backLink.href);
    } catch (error) {
      console.error("å‰Šé™¤ã‚¨ãƒ©ãƒ¼:", error);
      alert("å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ");
    }
  };

  if (loading) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div>
      </div>
    );
  }

  if (!game) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="text-center">
          <p className="text-gray-600 mb-4">è©¦åˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</p>
          <Link href={backLink.href} className="text-blue-600 hover:underline">
            {backLink.label}
          </Link>
        </div>
      </div>
    );
  }

  const formatDate = (dateStr: string) => {
    const date = new Date(dateStr);
    return date.toLocaleDateString("ja-JP", {
      year: "numeric",
      month: "long",
      day: "numeric",
      weekday: "long",
    });
  };

  const formatTime = (timeStr: string | null) => {
    if (!timeStr) return "";
    const [hours, minutes] = timeStr.split(":");
    return `${hours}:${minutes}`;
  };

  const getCategoryColor = (category?: string) => {
    switch (category) {
      case "official":
        return "bg-red-100 text-red-800";
      case "practice":
        return "bg-blue-100 text-blue-800";
      case "scrimmage":
        return "bg-green-100 text-green-800";
      default:
        return "bg-gray-100 text-gray-800";
    }
  };

  const getCategoryLabel = (category?: string) => {
    switch (category) {
      case "official":
        return "å…¬å¼æˆ¦";
      case "practice":
        return "ç·´ç¿’è©¦åˆ";
      case "scrimmage":
        return "ç´…ç™½æˆ¦";
      default:
        return "ãã®ä»–";
    }
  };

  return (
    <div className="min-h-screen bg-gray-50">
      <div className="container mx-auto px-4 py-8 max-w-4xl">
        {}
        <div className="mb-6">
          <Link
            href={backLink.href}
            className="text-blue-600 hover:underline text-sm"
          >
            â† {backLink.label}
          </Link>
        </div>

        {}
        <div className="bg-white rounded-lg shadow-lg overflow-hidden">
          {}
          <div className="px-6 py-4 bg-gradient-to-r from-blue-600 to-blue-700">
            <div className="flex justify-between items-start">
              <div>
                <h1 className="text-2xl font-bold text-white mb-2">
                  {game.name}
                </h1>
                {team && <p className="text-blue-100">ãƒãƒ¼ãƒ : {team.name}</p>}
              </div>
              <div className="flex items-start gap-2">
                {game.category && (
                  <span
                    className={`px-3 py-1 rounded-full text-sm font-semibold ${getCategoryColor(
                      game.category
                    )}`}
                  >
                    {getCategoryLabel(game.category)}
                  </span>
                )}
                <span
                  className={`px-3 py-1 rounded-full text-sm font-semibold ${
                    game.status === "completed"
                      ? "bg-gray-100 text-gray-700"
                      : game.status === "in_progress"
                      ? "bg-yellow-100 text-yellow-700"
                      : game.status === "cancelled"
                      ? "bg-red-100 text-red-700"
                      : "bg-green-100 text-green-700"
                  }`}
                >
                  {game.status === "completed"
                    ? "çµ‚äº†"
                    : game.status === "in_progress"
                    ? "é€²è¡Œä¸­"
                    : game.status === "cancelled"
                    ? "ä¸­æ­¢"
                    : "äºˆå®š"}
                </span>
              </div>
            </div>
          </div>

          {}
          <div className="px-6 py-6 border-b">
            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <h2 className="text-sm font-semibold text-gray-600 mb-2">
                  æ—¥æ™‚
                </h2>
                <p className="text-gray-900">
                  {formatDate(game.game_date)}
                  {game.game_time && ` ${formatTime(game.game_time)}`}
                </p>
              </div>

              <div>
                <h2 className="text-sm font-semibold text-gray-600 mb-2">
                  å¯¾æˆ¦ç›¸æ‰‹
                </h2>
                <p className="text-gray-900">{game.opponent_name}</p>
              </div>

              {game.location && (
                <div>
                  <h2 className="text-sm font-semibold text-gray-600 mb-2">
                    å ´æ‰€
                  </h2>
                  <p className="text-gray-900">{game.location}</p>
                </div>
              )}
            </div>

            {game.description && (
              <div className="mt-6">
                <h2 className="text-sm font-semibold text-gray-600 mb-2">
                  èª¬æ˜
                </h2>
                <p className="text-gray-900 whitespace-pre-wrap">
                  {game.description}
                </p>
              </div>
            )}
          </div>

          {}
          <div className="px-6 py-6 border-b">
            <h2 className="text-lg font-semibold text-gray-900 mb-4">
              ã‚¹ã‚³ã‚¢ãƒœãƒ¼ãƒ‰
            </h2>
            <InlineScoreInput
              gameId={gameId}
              canEdit={canEdit}
              onScoreUpdate={fetchGameData}
            />
          </div>

          {}
          <div className="px-6 py-6 border-b">
            <h2 className="text-lg font-semibold text-gray-900 mb-4">
              å‚åŠ ãƒ¡ãƒ³ãƒãƒ¼
            </h2>

            {gamePlayers.length === 0 ? (
              <p className="text-gray-500">ãƒ¡ãƒ³ãƒãƒ¼æƒ…å ±ã¯ã‚ã‚Šã¾ã›ã‚“</p>
            ) : (
              <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <h3 className="text-sm font-semibold text-gray-600 mb-2">
                    ã‚¹ã‚¿ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ¡ãƒ³ãƒãƒ¼
                  </h3>
                  <table className="w-full">
                    <thead>
                      <tr className="text-left text-sm text-gray-600">
                        <th className="pb-2">æ‰“é †</th>
                        <th className="pb-2">åå‰</th>
                        <th className="pb-2">å®ˆå‚™</th>
                      </tr>
                    </thead>
                    <tbody className="text-sm">
                      {gamePlayers
                        .filter((p) => p.is_starter)
                        .sort(
                          (a, b) =>
                            (a.batting_order || 0) - (b.batting_order || 0)
                        )
                        .map((player) => (
                          <tr key={player.id}>
                            <td className="px-4 py-2 text-sm text-gray-900">
                              {player.batting_order}
                            </td>
                            <td className="px-4 py-2 text-sm text-gray-900">
                              {player.player_name}
                            </td>
                            <td className="px-4 py-2 text-sm text-gray-900">
                              {player.position || "-"}
                            </td>
                          </tr>
                        ))}
                    </tbody>
                  </table>
                </div>
              </div>
            )}
          </div>

          {}
          <OperationTasksDisplay gameId={gameId} />

          {}
          {isTeamMember &&
            game.attendance_check_enabled &&
            game.home_team_id && (
              <div className="px-6 py-6 border-t">
                <h2 className="text-lg font-semibold text-gray-900 mb-4">
                  å‡ºæ¬ ç¢ºèª
                </h2>

                {}
                {attendances.length === 0 ? (
                  <div className="text-center py-8">
                    <p className="text-gray-600 mb-4">
                      å‡ºæ¬ ç¢ºèªãŒã¾ã é–‹å§‹ã•ã‚Œã¦ã„ã¾ã›ã‚“
                    </p>
                    <button
                      onClick={initializeAttendanceRecords}
                      className="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
                    >
                      å‡ºæ¬ ç¢ºèªã‚’é–‹å§‹ã™ã‚‹
                    </button>
                  </div>
                ) : (
                  <>
                    {}
                    {currentUserAttendance && (
                      <div className="mb-6 p-4 bg-blue-50 rounded-lg">
                        <div className="flex items-center justify-between">
                          <div>
                            <p className="text-sm font-medium text-gray-700">
                              ã‚ãªãŸã®å‡ºæ¬ å›ç­”
                            </p>
                            <p className="text-lg font-semibold text-gray-900 mt-1">
                              {currentUserAttendance.status === "pending" &&
                                "æœªå›ç­”"}
                              {currentUserAttendance.status === "attending" &&
                                "âœ… å‡ºå¸­"}
                              {currentUserAttendance.status === "absent" &&
                                "âŒ æ¬ å¸­"}
                            </p>
                          </div>
                          {currentUserAttendance.status === "pending" && (
                            <div className="flex gap-2">
                              <button
                                onClick={() =>
                                  handleAttendanceUpdate(
                                    currentUserAttendance.id,
                                    "attending"
                                  )
                                }
                                disabled={
                                  updatingAttendance ===
                                  currentUserAttendance.id
                                }
                                className="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50"
                              >
                                å‡ºå¸­ã™ã‚‹
                              </button>
                              <button
                                onClick={() =>
                                  handleAttendanceUpdate(
                                    currentUserAttendance.id,
                                    "absent"
                                  )
                                }
                                disabled={
                                  updatingAttendance ===
                                  currentUserAttendance.id
                                }
                                className="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50"
                              >
                                æ¬ å¸­ã™ã‚‹
                              </button>
                            </div>
                          )}
                          {currentUserAttendance.status !== "pending" && (
                            <div className="flex gap-2">
                              <button
                                onClick={() =>
                                  handleAttendanceUpdate(
                                    currentUserAttendance.id,
                                    currentUserAttendance.status === "attending"
                                      ? "absent"
                                      : "attending"
                                  )
                                }
                                disabled={
                                  updatingAttendance ===
                                  currentUserAttendance.id
                                }
                                className="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 disabled:opacity-50"
                              >
                                {currentUserAttendance.status === "attending"
                                  ? "æ¬ å¸­ã«å¤‰æ›´"
                                  : "å‡ºå¸­ã«å¤‰æ›´"}
                              </button>
                            </div>
                          )}
                        </div>
                      </div>
                    )}

                    {}
                    {attendances.filter((a) => a.status === "attending")
                      .length < 9 && (
                      <div className="mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                        <p className="text-yellow-800">
                          âš ï¸ ç¾åœ¨ã®å‡ºå¸­è€…ã¯{" "}
                          <span className="font-bold">
                            {
                              attendances.filter(
                                (a) => a.status === "attending"
                              ).length
                            }
                            äºº
                          </span>
                          ã§ã™ã€‚è©¦åˆæˆç«‹ã«ã¯æœ€ä½9äººãŒå¿…è¦ã§ã™ã€‚
                        </p>
                      </div>
                    )}

                    {}
                    <div className="space-y-4">
                      <div className="flex justify-between text-sm text-gray-600 mb-2">
                        <span>
                          å‡ºå¸­:{" "}
                          {
                            attendances.filter((a) => a.status === "attending")
                              .length
                          }
                          äºº
                        </span>
                        <span>
                          æ¬ å¸­:{" "}
                          {
                            attendances.filter((a) => a.status === "absent")
                              .length
                          }
                          äºº
                        </span>
                        <span>
                          æœªå›ç­”:{" "}
                          {
                            attendances.filter((a) => a.status === "pending")
                              .length
                          }
                          äºº
                        </span>
                      </div>

                      <div className="grid grid-cols-1 sm:grid-cols-2 gap-2">
                        {attendances.map((attendance) => (
                          <div
                            key={attendance.id}
                            className={`p-3 rounded-lg border ${
                              attendance.status === "attending"
                                ? "bg-green-50 border-green-200"
                                : attendance.status === "absent"
                                ? "bg-gray-50 border-gray-200"
                                : "bg-yellow-50 border-yellow-200"
                            }`}
                          >
                            <div className="flex items-center justify-between">
                              <span className="font-medium">
                                {attendance.person_name ||
                                  attendance.team_member?.user_profiles
                                    ?.display_name ||
                                  "åå‰æœªè¨­å®š"}
                              </span>
                              <span
                                className={`text-sm font-semibold ${
                                  attendance.status === "attending"
                                    ? "text-green-700"
                                    : attendance.status === "absent"
                                    ? "text-gray-600"
                                    : "text-yellow-700"
                                }`}
                              >
                                {attendance.status === "attending" && "å‡ºå¸­"}
                                {attendance.status === "absent" && "æ¬ å¸­"}
                                {attendance.status === "pending" && "æœªå›ç­”"}
                              </span>
                            </div>
                          </div>
                        ))}
                      </div>
                    </div>

                    {}
                    {canEdit && (
                      <div className="mt-6 p-4 bg-gray-50 rounded-lg">
                        <h3 className="text-sm font-semibold text-gray-700 mb-3">
                          ã‚²ã‚¹ãƒˆï¼ˆåŠ©ã£äººï¼‰ã‚’è¿½åŠ 
                        </h3>
                        <div className="flex gap-2">
                          <input
                            type="text"
                            value={guestName}
                            onChange={(e) => setGuestName(e.target.value)}
                            placeholder="ã‚²ã‚¹ãƒˆã®åå‰"
                            className="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                          />
                          <button
                            onClick={addGuestAttendance}
                            disabled={addingGuest || !guestName.trim()}
                            className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50"
                          >
                            {addingGuest ? "è¿½åŠ ä¸­..." : "è¿½åŠ "}
                          </button>
                        </div>
                      </div>
                    )}
                  </>
                )}
              </div>
            )}

          {}
          {}
{game.status !== "scheduled" && (
  <div className="bg-white rounded-lg shadow p-6 mt-6">
    <div className="flex justify-between items-center mb-4">
      <h2 className="text-xl font-bold">è©¦åˆã‚¹ã‚³ã‚¢ãƒœãƒƒã‚¯ã‚¹</h2>
      {canEdit && gamePlayers.length === 0 && (
  <p className="text-sm text-gray-600">
    é¸æ‰‹åã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦é¸æ‰‹ã‚’è¿½åŠ ã—ã¦ãã ã•ã„
  </p>
)}
    </div>
    <ScoreBoxDisplay
                gameId={gameId}
                isEditable={canEdit}
                gameStatus={game.status}
              />
            </div>
          )}

          {}
          {canEdit && (
            <div className="px-6 py-4 bg-gray-50 border-t">
              <div className="flex justify-between">
                {}
                <div className="flex gap-4">
                  <Link
                    href={`/games/${gameId}/players`}
                    className="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700"
                  >
                    ãƒ¡ãƒ³ãƒãƒ¼ç®¡ç†
                  </Link>
                  <Link
                    href={`/games/${gameId}/progress`}
                    className="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700"
                  >
                    è©¦åˆé€²è¡Œç®¡ç†
                  </Link>
                  <Link
                    href={`/games/${gameId}/operations`}
                    className="px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700"
                  >
                    é‹å–¶ã‚¿ã‚¹ã‚¯ç®¡ç†
                  </Link>
                </div>

                {}
                <div className="flex gap-4">
                  <Link
                    href={`/games/${gameId}/edit`}
                    className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
                  >
                    ç·¨é›†
                  </Link>

                  {}
                  <button
                    onClick={handleDelete}
                    className="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700"
                  >
                    å‰Šé™¤
                  </button>
                </div>
              </div>
            </div>
          )}
        </div>
      </div>
    </div>
  );
}


================================================================================
FILE: src/app/games/[gameId]/players/page.tsx
================================================================================

"use client";

import { use, useEffect, useState } from "react";
import { createClientComponentClient } from "@supabase/auth-helpers-nextjs";
import { useAuth } from "@/components/auth/AuthProvider";
import { useRouter } from "next/navigation";
import Link from "next/link";

interface PageProps {
  params: Promise<{
    gameId: string;
  }>;
}

interface Game {
  id: string;
  name: string;
  game_date: string;
  home_team_id: string | null;
  opponent_name: string;
  created_by: string;
  status: string;
}

interface TeamMember {
  id: string;
  team_id: string;
  user_id: string;
  role: string;
  user_profiles?: {
    display_name: string;
  };
}

interface GamePlayer {
  id?: string;
  game_id: string;
  player_name: string;
  team_member_id: string | null;
  is_starter: boolean;
  batting_order: number | null;
  position: string | null;
  is_active: boolean;
}

interface StarterSlot {
  batting_order: number;
  player_name: string;
  team_member_id: string;
  position: string;
  existing_id?: string;
}

interface DefaultLineupPlayer {
  id?: string;
  team_id: string;
  player_name: string;
  team_member_id: string | null;
  batting_order: number | null;
  position: string | null;
  is_starter: boolean;
}

const POSITIONS = [
  { value: "æŠ•æ‰‹", label: "æŠ•æ‰‹" },
  { value: "æ•æ‰‹", label: "æ•æ‰‹" },
  { value: "ä¸€å¡æ‰‹", label: "ä¸€å¡æ‰‹" },
  { value: "äºŒå¡æ‰‹", label: "äºŒå¡æ‰‹" },
  { value: "ä¸‰å¡æ‰‹", label: "ä¸‰å¡æ‰‹" },
  { value: "éŠæ’ƒæ‰‹", label: "éŠæ’ƒæ‰‹" },
  { value: "å·¦ç¿¼æ‰‹", label: "å·¦ç¿¼æ‰‹" },
  { value: "ä¸­å …æ‰‹", label: "ä¸­å …æ‰‹" },
  { value: "å³ç¿¼æ‰‹", label: "å³ç¿¼æ‰‹" },
  { value: "æŒ‡åæ‰“è€…", label: "æŒ‡åæ‰“è€…" },
];

export default function MemberManagementPage({ params }: PageProps) {
  const resolvedParams = use(params);
  const gameId = resolvedParams.gameId;
  const router = useRouter();
  const { user, loading: authLoading } = useAuth();
  const supabase = createClientComponentClient();

  const [game, setGame] = useState<Game | null>(null);
  const [teamMembers, setTeamMembers] = useState<TeamMember[]>([]);
  const [starterSlots, setStarterSlots] = useState<StarterSlot[]>([]);
  const [substitutes, setSubstitutes] = useState<GamePlayer[]>([]);
  const [newSubstitute, setNewSubstitute] = useState({
    name: "",
    teamMemberId: "",
  });
  const [useDH, setUseDH] = useState(false);
  const [canEdit, setCanEdit] = useState(false);
  const [loading, setLoading] = useState(true);
  const [saving, setSaving] = useState(false);
  const [error, setError] = useState("");
  const [hasExistingData, setHasExistingData] = useState(false);

  useEffect(() => {

    if (authLoading) return;

    if (!user) {
      router.push("/login");
      return;
    }

    fetchData();
  }, [gameId, user, authLoading]);

  const initializeSlots = (
    existingPlayers: GamePlayer[] = [],
    defaultLineup: DefaultLineupPlayer[] = []
  ) => {
    const slots: StarterSlot[] = [];
    const maxOrder = useDH ? 10 : 9;

    for (let i = 1; i <= maxOrder; i++) {

      const existing = existingPlayers.find(
        (p) => p.batting_order === i && p.is_starter
      );
      if (existing) {
        slots.push({
          batting_order: i,
          player_name: existing.player_name,
          team_member_id: existing.team_member_id || "",
          position: existing.position || "",
          existing_id: existing.id,
        });
      } else {

        const defaultPlayer = defaultLineup.find(
          (p) => p.batting_order === i && p.is_starter
        );
        if (defaultPlayer) {
          slots.push({
            batting_order: i,
            player_name: defaultPlayer.player_name,
            team_member_id: defaultPlayer.team_member_id || "",
            position: defaultPlayer.position || "",
          });
        } else {

          slots.push({
            batting_order: i,
            player_name: "",
            team_member_id: "",
            position: i === 10 ? "æŒ‡åæ‰“è€…" : "",
          });
        }
      }
    }
    setStarterSlots(slots);
  };

  const fetchData = async () => {
    try {

      const { data: gameData, error: gameError } = await supabase
        .from("games")
        .select("*")
        .eq("id", gameId)
        .single();

      if (gameError || !gameData) {
        setError("è©¦åˆæƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ");
        return;
      }

      setGame(gameData);

      const isOwner = gameData.created_by === user?.id;
      const isTeamOwner = await checkTeamOwnership(gameData.home_team_id);
      setCanEdit(isOwner || isTeamOwner);

      if (gameData.home_team_id) {
        const { data: membersData } = await supabase
          .from("team_members")
          .select("*")
          .eq("team_id", gameData.home_team_id);

        if (membersData) {

          const userIds = membersData.map((m) => m.user_id);
          const { data: profiles } = await supabase
            .from("user_profiles")
            .select("id, display_name")
            .in("id", userIds);

          const membersWithProfiles = membersData.map((member) => ({
            ...member,
            user_profiles:
              profiles?.find((p) => p.id === member.user_id) || null,
          }));

          setTeamMembers(membersWithProfiles);
        }

        const { data: defaultLineupData } = await supabase
          .from("team_default_lineup")
          .select("*")
          .eq("team_id", gameData.home_team_id);

        const { data: playersData } = await supabase
          .from("game_players")
          .select("*")
          .eq("game_id", gameId)
          .eq("is_active", true);

        if (playersData && playersData.length > 0) {

          setHasExistingData(true);
          const hasDH = playersData.some(
            (p) => p.batting_order === 10 || p.position === "æŒ‡åæ‰“è€…"
          );
          setUseDH(hasDH);

          initializeSlots(playersData, []);

          const subs = playersData.filter((p) => !p.is_starter);
          setSubstitutes(subs);
        } else if (defaultLineupData && defaultLineupData.length > 0) {

          const hasDH = defaultLineupData.some(
            (p) => p.batting_order === 10 || p.position === "æŒ‡åæ‰“è€…"
          );
          setUseDH(hasDH);

          initializeSlots([], defaultLineupData);

          const defaultSubs = defaultLineupData
            .filter((p) => !p.is_starter)
            .map((p) => ({
              game_id: gameId,
              player_name: p.player_name,
              team_member_id: p.team_member_id,
              is_starter: false,
              batting_order: null,
              position: null,
              is_active: true,
            }));
          setSubstitutes(defaultSubs);
        } else {

          initializeSlots();
        }
      }
    } catch (error) {
      console.error("ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼:", error);
      setError("ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ");
    } finally {
      setLoading(false);
    }
  };

  const checkTeamOwnership = async (teamId: string | null) => {
    if (!teamId || !user) return false;

    const { data } = await supabase
      .from("teams")
      .select("owner_id")
      .eq("id", teamId)
      .single();

    return data?.owner_id === user.id;
  };

  const getSelectedMemberIds = (excludeIndex?: number): string[] => {
    const ids: string[] = [];

    starterSlots.forEach((slot, index) => {
      if (slot.team_member_id && index !== excludeIndex) {
        ids.push(slot.team_member_id);
      }
    });

    substitutes.forEach((sub) => {
      if (sub.team_member_id) {
        ids.push(sub.team_member_id);
      }
    });

    return ids;
  };

  const getSelectedPositions = (excludeIndex?: number): string[] => {
    const positions: string[] = [];

    starterSlots.forEach((slot, index) => {
      if (
        slot.position &&
        index !== excludeIndex &&
        slot.position !== "æŒ‡åæ‰“è€…"
      ) {
        positions.push(slot.position);
      }
    });

    return positions;
  };

  const updateSlot = (
    index: number,
    field: keyof StarterSlot,
    value: string
  ) => {
    const newSlots = [...starterSlots];

    if (field === "team_member_id") {
      if (value) {
        const member = teamMembers.find((m) => m.id === value);
        if (member) {
          newSlots[index] = {
            ...newSlots[index],
            team_member_id: value,
            player_name: member.user_profiles?.display_name || "åå‰æœªè¨­å®š",
          };
        }
      } else {
        newSlots[index] = {
          ...newSlots[index],
          team_member_id: "",
          player_name: "",
        };
      }
    } else if (field === "player_name") {
      newSlots[index] = {
        ...newSlots[index],
        player_name: value,
        team_member_id: "",
      };
    } else {
      newSlots[index] = {
        ...newSlots[index],
        [field]: value,
      };
    }

    setStarterSlots(newSlots);
  };

  const handleDHToggle = () => {
    if (!useDH) {

      setUseDH(true);
      setStarterSlots([
        ...starterSlots,
        {
          batting_order: 10,
          player_name: "",
          team_member_id: "",
          position: "æŒ‡åæ‰“è€…",
        },
      ]);
    } else {

      setUseDH(false);
      setStarterSlots(starterSlots.filter((s) => s.batting_order !== 10));
    }
  };

  const addSubstitute = () => {
    if (!newSubstitute.name && !newSubstitute.teamMemberId) {
      alert("æ§ãˆãƒ¡ãƒ³ãƒãƒ¼ã®åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
      return;
    }

    let playerName = "";
    let teamMemberId: string | null = null;

    if (newSubstitute.teamMemberId) {
      const member = teamMembers.find(
        (m) => m.id === newSubstitute.teamMemberId
      );
      if (member) {
        playerName = member.user_profiles?.display_name || "åå‰æœªè¨­å®š";
        teamMemberId = member.id;
      }
    } else {
      playerName = newSubstitute.name;
    }

    const newSub: GamePlayer = {
      game_id: gameId,
      player_name: playerName,
      team_member_id: teamMemberId,
      is_starter: false,
      batting_order: null,
      position: null,
      is_active: true,
    };

    setSubstitutes([...substitutes, newSub]);
    setNewSubstitute({ name: "", teamMemberId: "" });
  };

  const removeSubstitute = (index: number) => {
    setSubstitutes(substitutes.filter((_, i) => i !== index));
  };

  const saveLineup = async () => {
    if (!game?.home_team_id) {
      alert("ãƒãƒ¼ãƒ æƒ…å ±ãŒã‚ã‚Šã¾ã›ã‚“");
      return;
    }

    setSaving(true);
    setError("");

    try {

      await supabase.from("game_players").delete().eq("game_id", gameId);

      const playersToInsert: any[] = [];

      starterSlots.forEach((slot) => {
        if (slot.player_name) {
          playersToInsert.push({
            game_id: gameId,
            player_name: slot.player_name,
            team_member_id: slot.team_member_id || null,
            is_starter: true,
            batting_order: slot.batting_order,
            position: slot.position || null,
            is_active: true,
          });
        }
      });

      substitutes.forEach((sub) => {
        playersToInsert.push({
          game_id: gameId,
          player_name: sub.player_name,
          team_member_id: sub.team_member_id || null,
          is_starter: false,
          batting_order: null,
          position: null,
          is_active: true,
        });
      });

      if (playersToInsert.length > 0) {
        const { error: insertError } = await supabase
          .from("game_players")
          .insert(playersToInsert);

        if (insertError) {
          throw insertError;
        }
      }

      await supabase
        .from("team_default_lineup")
        .delete()
        .eq("team_id", game.home_team_id);

      const defaultLineupToInsert: any[] = [];

      starterSlots.forEach((slot) => {
        if (slot.player_name) {
          defaultLineupToInsert.push({
            team_id: game.home_team_id,
            player_name: slot.player_name,
            team_member_id: slot.team_member_id || null,
            batting_order: slot.batting_order,
            position: slot.position || null,
            is_starter: true,
          });
        }
      });

      substitutes.forEach((sub) => {
        defaultLineupToInsert.push({
          team_id: game.home_team_id,
          player_name: sub.player_name,
          team_member_id: sub.team_member_id || null,
          batting_order: null,
          position: null,
          is_starter: false,
        });
      });

      if (defaultLineupToInsert.length > 0) {
        const { error: defaultError } = await supabase
          .from("team_default_lineup")
          .insert(defaultLineupToInsert);

        if (defaultError) {
          console.error("ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ©ã‚¤ãƒ³ãƒŠãƒƒãƒ—ä¿å­˜ã‚¨ãƒ©ãƒ¼:", defaultError);

        }
      }

      alert("ãƒ¡ãƒ³ãƒãƒ¼è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ");
      router.push(`/games/${gameId}`);
    } catch (error) {
      console.error("ä¿å­˜ã‚¨ãƒ©ãƒ¼:", error);
      setError("ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ");
    } finally {
      setSaving(false);
    }
  };

  if (loading) {
    return (
      <div className="min-h-screen bg-gray-50 flex items-center justify-center">
        <div className="text-gray-600">èª­ã¿è¾¼ã¿ä¸­...</div>
      </div>
    );
  }

  if (!game) {
    return (
      <div className="min-h-screen bg-gray-50 flex items-center justify-center">
        <div className="text-red-600">è©¦åˆæƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-gray-50 py-8">
      <div className="max-w-6xl mx-auto px-4">
        <div className="mb-6">
          <Link
            href={`/games/${gameId}`}
            className="inline-flex items-center text-gray-600 hover:text-gray-900"
          >
            <svg
              className="w-5 h-5 mr-2"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                strokeLinecap="round"
                strokeLinejoin="round"
                strokeWidth={2}
                d="M15 19l-7-7 7-7"
              />
            </svg>
            è©¦åˆè©³ç´°ã«æˆ»ã‚‹
          </Link>
        </div>

        <div className="bg-white rounded-lg shadow">
          <div className="p-6 border-b">
            <h1 className="text-2xl font-bold text-gray-900">ãƒ¡ãƒ³ãƒãƒ¼ç®¡ç†</h1>
            <p className="mt-2 text-gray-600">
              {game.name} -{" "}
              {new Date(game.game_date).toLocaleDateString("ja-JP")}
            </p>
            {!hasExistingData && (
              <p className="mt-2 text-sm text-blue-600">
                â€» å‰å›ã®è¨­å®šå†…å®¹ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¨ã—ã¦èª­ã¿è¾¼ã‚“ã§ã„ã¾ã™
              </p>
            )}
          </div>

          {error && (
            <div className="mx-6 mt-6 p-4 bg-red-50 border border-red-200 rounded text-red-700">
              {error}
            </div>
          )}

          <div className="p-6">
            {}
            <div className="mb-6">
              <label className="flex items-center">
                <input
                  type="checkbox"
                  checked={useDH}
                  onChange={handleDHToggle}
                  disabled={!canEdit}
                  className="mr-2"
                />
                <span className="text-gray-700">DHï¼ˆæŒ‡åæ‰“è€…ï¼‰åˆ¶ã‚’ä½¿ç”¨</span>
              </label>
            </div>

            {}
            <div className="mb-8">
              <h2 className="text-lg font-semibold text-gray-900 mb-4">
                ã‚¹ã‚¿ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ¡ãƒ³ãƒãƒ¼
              </h2>
              <div className="space-y-3">
                {starterSlots.map((slot, index) => {
                  const selectedIds = getSelectedMemberIds(index);
                  const availableMembers = teamMembers.filter(
                    (m) => !selectedIds.includes(m.id)
                  );

                  return (
                    <div
                      key={slot.batting_order}
                      className="flex gap-4 items-center"
                    >
                      <span className="w-8 text-gray-600 font-medium">
                        {slot.batting_order}.
                      </span>

                      <div className="flex-1 flex gap-2">
                        <select
                          value={slot.team_member_id}
                          onChange={(e) =>
                            updateSlot(index, "team_member_id", e.target.value)
                          }
                          disabled={!canEdit}
                          className="flex-1 px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                        >
                          <option value="">ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ã‹ã‚‰é¸æŠ</option>
                          {slot.team_member_id && (
                            <option value={slot.team_member_id}>
                              {teamMembers.find(
                                (m) => m.id === slot.team_member_id
                              )?.user_profiles?.display_name || "åå‰æœªè¨­å®š"}
                            </option>
                          )}
                          {availableMembers.map((member) => (
                            <option key={member.id} value={member.id}>
                              {member.user_profiles?.display_name ||
                                "åå‰æœªè¨­å®š"}
                            </option>
                          ))}
                        </select>

                        <input
                          type="text"
                          value={slot.team_member_id ? "" : slot.player_name}
                          onChange={(e) =>
                            updateSlot(index, "player_name", e.target.value)
                          }
                          placeholder="ã¾ãŸã¯ç›´æ¥å…¥åŠ›"
                          disabled={!canEdit || !!slot.team_member_id}
                          className="flex-1 px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100"
                        />
                      </div>

                      <select
                        value={slot.position}
                        onChange={(e) =>
                          updateSlot(index, "position", e.target.value)
                        }
                        disabled={!canEdit}
                        className="w-32 px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                      >
                        <option value="">å®ˆå‚™ä½ç½®</option>
                        {POSITIONS.map((pos) => {
                          const isSelected = getSelectedPositions(
                            index
                          ).includes(pos.value);
                          const isDisabled =
                            isSelected && pos.value !== "æŒ‡åæ‰“è€…";

                          return (
                            <option
                              key={pos.value}
                              value={pos.value}
                              disabled={isDisabled}
                            >
                              {pos.label}
                              {isDisabled ? " (é¸æŠæ¸ˆ)" : ""}
                            </option>
                          );
                        })}
                      </select>
                    </div>
                  );
                })}
              </div>
            </div>

            {}
            <div className="mb-8">
              <h2 className="text-lg font-semibold text-gray-900 mb-4">
                æ§ãˆãƒ¡ãƒ³ãƒãƒ¼
              </h2>

              {}
              {substitutes.length > 0 && (
                <div className="mb-4 space-y-2">
                  {substitutes.map((sub, index) => (
                    <div
                      key={index}
                      className="flex items-center gap-4 p-3 bg-gray-50 rounded"
                    >
                      <span className="flex-1">{sub.player_name}</span>
                      {canEdit && (
                        <button
                          onClick={() => removeSubstitute(index)}
                          className="text-red-600 hover:text-red-700"
                        >
                          å‰Šé™¤
                        </button>
                      )}
                    </div>
                  ))}
                </div>
              )}

              {}
              {canEdit && (
                <div className="flex gap-2">
                  <select
                    value={newSubstitute.teamMemberId}
                    onChange={(e) =>
                      setNewSubstitute({
                        ...newSubstitute,
                        teamMemberId: e.target.value,
                        name: "",
                      })
                    }
                    className="flex-1 px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                  >
                    <option value="">ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ã‹ã‚‰é¸æŠ</option>
                    {teamMembers
                      .filter((m) => !getSelectedMemberIds().includes(m.id))
                      .map((member) => (
                        <option key={member.id} value={member.id}>
                          {member.user_profiles?.display_name || "åå‰æœªè¨­å®š"}
                        </option>
                      ))}
                  </select>

                  <input
                    type="text"
                    value={newSubstitute.teamMemberId ? "" : newSubstitute.name}
                    onChange={(e) =>
                      setNewSubstitute({
                        ...newSubstitute,
                        name: e.target.value,
                        teamMemberId: "",
                      })
                    }
                    placeholder="ã¾ãŸã¯ç›´æ¥å…¥åŠ›"
                    disabled={!!newSubstitute.teamMemberId}
                    className="flex-1 px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100"
                  />

                  <button
                    onClick={addSubstitute}
                    className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
                  >
                    è¿½åŠ 
                  </button>
                </div>
              )}
            </div>

            {}
            {canEdit && (
              <div className="flex justify-end gap-4">
                <button
                  onClick={() => router.push(`/games/${gameId}`)}
                  disabled={saving}
                  className="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50"
                >
                  ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                </button>
                <button
                  onClick={saveLineup}
                  disabled={saving}
                  className="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50"
                >
                  {saving ? "ä¿å­˜ä¸­..." : "ä¿å­˜"}
                </button>
              </div>
            )}
          </div>
        </div>
      </div>
    </div>
  );
}


================================================================================
FILE: src/app/games/[gameId]/progress/page.tsx
================================================================================

"use client";

import { use, useEffect, useState } from "react";
import { createClientComponentClient } from "@supabase/auth-helpers-nextjs";
import { useAuth } from "@/components/auth/AuthProvider";
import { useRouter } from "next/navigation";
import Link from "next/link";
import BattingRecordInput from "@/components/game/BattingRecordInput";
import PlayerSubstitution from "@/components/game/PlayerSubstitution";
import StatsDisplay from "@/components/game/StatsDisplay";
import PitchingRecordInput from "@/components/game/PitchingRecordInput";
import PitchingStatsDisplay from "@/components/game/PitchingStatsDisplay";
import RunnerDisplay from "@/components/game/RunnerDisplay";

interface Game {
  id: string;
  name: string;
  game_date: string;
  status: string;
  home_team_id: string;
  home_score: number;
  opponent_score: number;
  opponent_name: string;
  created_by: string;
}

interface GamePlayer {
  id: string;
  game_id: string;
  player_name: string;
  team_member_id: string | null;
  is_starter: boolean;
  batting_order: number | null;
  position: string | null;
  is_active: boolean;
}

interface InningData {
  inning: number;
  topBottom: "top" | "bottom";
  currentBatter: GamePlayer | null;
  runs: number;
  hits: number;
  errors: number;
  outs: number;
  isCompleted: boolean;
  isLocked: boolean;
}

interface BattingRecord {
  id: string;
  game_id: string;
  player_id: string;
  inning: number;
  result: string;
  rbi: number;
  run_scored: boolean;
}

const OUT_RESULTS = [
  "ä¸‰æŒ¯",
  "ã‚´ãƒ­",
  "ãƒ•ãƒ©ã‚¤",
  "ãƒ©ã‚¤ãƒŠãƒ¼",
  "çŠ æ‰“",
  "çŠ é£›",
  "ãƒ•ã‚£ãƒ¼ãƒ«ãƒ€ãƒ¼ã‚¹ãƒãƒ§ã‚¤ã‚¹",
];

const MAX_INNINGS = 7;

export default function GameProgressPage({
  params,
}: {
  params: Promise<{ gameId: string }>;
}) {
  const { gameId } = use(params);
  const router = useRouter();
  const { user, loading: authLoading } = useAuth();
  const supabase = createClientComponentClient();

  const [loading, setLoading] = useState(true);
  const [game, setGame] = useState<Game | null>(null);
  const [players, setPlayers] = useState<GamePlayer[]>([]);
  const [activeTab, setActiveTab] = useState<
    "batting" | "substitution" | "pitching" | "stats"
  >("batting");
  const [canEdit, setCanEdit] = useState(false);
  const [selectedInning, setSelectedInning] = useState(1);
  const [selectedTopBottom, setSelectedTopBottom] = useState<"top" | "bottom">(
    "top"
  );
  const [currentInning, setCurrentInning] = useState<InningData | null>(null);
  const [allInningsData, setAllInningsData] = useState<Map<string, InningData>>(
    new Map()
  );
  const [battingRecords, setBattingRecords] = useState<BattingRecord[]>([]);
  const [isMyTeamBatFirst, setIsMyTeamBatFirst] = useState<boolean | null>(
    null
  );
  const [runnerRefreshTrigger, setRunnerRefreshTrigger] = useState(0);

  useEffect(() => {

    if (authLoading) return;

    if (!user) {
      router.push("/login");
      return;
    }

    fetchGameData();
  }, [user, authLoading, gameId]);

  useEffect(() => {
    if (selectedInning && selectedTopBottom) {
      loadInningData(selectedInning, selectedTopBottom);
    }
  }, [selectedInning, selectedTopBottom]);

  const fetchGameData = async () => {
    try {
      setLoading(true);

      const { data: gameData, error: gameError } = await supabase
        .from("games")
        .select("*")
        .eq("id", gameId)
        .single();

      if (gameError || !gameData) {
        console.error("è©¦åˆæƒ…å ±å–å¾—ã‚¨ãƒ©ãƒ¼:", gameError);

        if (gameError?.code === "PGRST116") {
          router.push("/dashboard");
        }

        return;
      }

      setGame(gameData);

      const isOwner = gameData.created_by === user?.id;
      const { data: teamMember } = await supabase
        .from("team_members")
        .select("role")
        .eq("team_id", gameData.home_team_id)
        .eq("user_id", user?.id)
        .single();

      setCanEdit(
        isOwner || teamMember?.role === "admin" || teamMember?.role === "member"
      );

      const { data: scoreData } = await supabase
        .from("game_scores")
        .select("is_my_team_bat_first")
        .eq("game_id", gameId)
        .limit(1)
        .single();

      if (scoreData) {
        setIsMyTeamBatFirst(scoreData.is_my_team_bat_first);
      }

      await fetchPlayers();
      await loadAllInningsData();
    } catch (error) {
      console.error("ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼:", error);
    } finally {
      setLoading(false);
    }
  };

  const fetchPlayers = async () => {
    try {
      const { data, error } = await supabase
        .from("game_players")
        .select("*")
        .eq("game_id", gameId)
        .order("batting_order", { ascending: true });

      if (error) throw error;
      if (data) {
        setPlayers(data);
      }
    } catch (error) {
      console.error("é¸æ‰‹ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼:", error);
    }
  };

  const loadAllInningsData = async () => {
    try {

      const { data: records } = await supabase
        .from("game_batting_records")
        .select("*")
        .eq("game_id", gameId)
        .order("inning", { ascending: true });

      if (records) {
        setBattingRecords(records);
      }

      const inningsMap = new Map<string, InningData>();

      const myTeamTopBottom = isMyTeamBatFirst ? "top" : "bottom";

      for (let inning = 1; inning <= MAX_INNINGS; inning++) {
        const key = `${inning}-${myTeamTopBottom}`;
        const inningRecords = records?.filter((r) => r.inning === inning) || [];

        let outCount = 0;
        inningRecords.forEach((r) => {
          if (OUT_RESULTS.includes(r.result)) {
            if (r.notes?.includes("ä½µæ®ºï¼ˆãƒ€ãƒ–ãƒ«ãƒ—ãƒ¬ãƒ¼ï¼‰")) {
              outCount += 2;
            } else if (r.notes?.includes("ä¸‰é‡æ®ºï¼ˆãƒˆãƒªãƒ—ãƒ«ãƒ—ãƒ¬ãƒ¼ï¼‰")) {
              outCount += 3;
            } else {
              outCount += 1;
            }
          }
        });
        const hitCount = inningRecords.filter((r) =>
          ["å®‰æ‰“", "äºŒå¡æ‰“", "ä¸‰å¡æ‰“", "æœ¬å¡æ‰“"].includes(r.result)
        ).length;
        const runCount = inningRecords
          .filter((r) => r.run_scored)
          .reduce((sum) => sum + 1, 0);

        inningsMap.set(key, {
          inning,
          topBottom: myTeamTopBottom,
          currentBatter: null,
          runs: runCount,
          hits: hitCount,
          errors: 0,
          outs: outCount,
          isCompleted: outCount >= 3,
          isLocked: outCount >= 3,
        });
      }

      setAllInningsData(inningsMap);

      if (records && records.length > 0) {
        const maxRecordedInning = Math.max(...records.map((r) => r.inning));
        const currentInningRecords = records.filter(
          (r) => r.inning === maxRecordedInning
        );

        let currentOuts = 0;
        currentInningRecords.forEach((r) => {
          if (OUT_RESULTS.includes(r.result)) {
            if (r.notes?.includes("ä½µæ®ºï¼ˆãƒ€ãƒ–ãƒ«ãƒ—ãƒ¬ãƒ¼ï¼‰")) {
              currentOuts += 2;
            } else if (r.notes?.includes("ä¸‰é‡æ®ºï¼ˆãƒˆãƒªãƒ—ãƒ«ãƒ—ãƒ¬ãƒ¼ï¼‰")) {
              currentOuts += 3;
            } else {
              currentOuts += 1;
            }
          }
        });

        if (currentOuts >= 3) {
          const nextInning = maxRecordedInning + 1;
          if (nextInning <= MAX_INNINGS) {
            setSelectedInning(nextInning);
            setSelectedTopBottom(myTeamTopBottom);
          } else {

            setSelectedInning(MAX_INNINGS);
            setSelectedTopBottom(myTeamTopBottom);
          }
        } else {
          setSelectedInning(maxRecordedInning);
          setSelectedTopBottom(myTeamTopBottom);
        }
      } else {
        setSelectedInning(1);
        setSelectedTopBottom(myTeamTopBottom);
      }
    } catch (error) {
      console.error("ã‚¤ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:", error);
    }
  };

  const loadInningData = async (
    inning: number,
    topBottom: "top" | "bottom"
  ) => {
    const key = `${inning}-${topBottom}`;
    const data = allInningsData.get(key);

    if (data) {
      setCurrentInning(data);
    } else {
      setCurrentInning({
        inning,
        topBottom,
        currentBatter: null,
        runs: 0,
        hits: 0,
        errors: 0,
        outs: 0,
        isCompleted: false,
        isLocked: false,
      });
    }

    if (isMyTeamBatFirst !== null) {
      const opponentTopBottom = isMyTeamBatFirst ? "bottom" : "top";
      const { data: scoreData } = await supabase
        .from("game_scores")
        .select("*")
        .eq("game_id", gameId)
        .eq("inning", inning)
        .single();

      if (scoreData) {
        const score =
          opponentTopBottom === "top"
            ? scoreData.top_score
            : scoreData.bottom_score;

      }
    }
  };

  const handleInningChange = (
    newInning: number,
    newTopBottom: "top" | "bottom"
  ) => {
    setSelectedInning(newInning);
    setSelectedTopBottom(newTopBottom);

  };

  const checkGameEnd = () => {
    const completedCount = Array.from(allInningsData.values()).filter(
      (data) => data.isCompleted
    ).length;

    if (completedCount >= MAX_INNINGS) {

      alert("è©¦åˆãŒçµ‚äº†ã—ã¾ã—ãŸï¼");

    }
  };

  if (loading) {
    return (
      <div className="min-h-screen bg-gray-50 flex items-center justify-center">
        <div className="text-center">
          <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"></div>
          <p className="mt-4 text-gray-600">èª­ã¿è¾¼ã¿ä¸­...</p>
        </div>
      </div>
    );
  }

  if (!game) {
    return (
      <div className="min-h-screen bg-gray-50 flex items-center justify-center">
        <div className="text-center">
          <p className="text-gray-600">è©¦åˆæƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</p>
          <Link
            href="/dashboard"
            className="mt-4 inline-block text-blue-600 hover:underline"
          >
            ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«æˆ»ã‚‹
          </Link>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-gray-50">
      <div className="max-w-7xl mx-auto px-4 py-8">
        {}
        <div className="mb-6">
          <Link
            href={`/games/${gameId}`}
            className="text-blue-600 hover:underline mb-2 inline-block"
          >
            â† è©¦åˆè©³ç´°ã«æˆ»ã‚‹
          </Link>
          <h1 className="text-3xl font-bold text-gray-900">{game.name}</h1>
          <div className="mt-2 text-gray-600">
            <span>{new Date(game.game_date).toLocaleDateString("ja-JP")}</span>
            <span className="mx-2">vs</span>
            <span>{game.opponent_name}</span>
          </div>
        </div>

        {}
        {isMyTeamBatFirst !== null && (
          <div className="mb-6 bg-white rounded-lg shadow p-4">
            <div className="flex space-x-2 overflow-x-auto">
              {Array.from({ length: MAX_INNINGS }, (_, i) => i + 1).map(
                (inning) => {
                  const key = `${inning}-${
                    isMyTeamBatFirst ? "top" : "bottom"
                  }`;
                  const data = allInningsData.get(key);
                  const isActive = selectedInning === inning;

                  return (
                    <button
                      key={inning}
                      onClick={() =>
                        handleInningChange(
                          inning,
                          isMyTeamBatFirst ? "top" : "bottom"
                        )
                      }
                      className={`px-4 py-2 rounded-lg whitespace-nowrap ${
                        isActive
                          ? "bg-blue-600 text-white"
                          : data?.isCompleted
                          ? "bg-green-100 text-green-800"
                          : "bg-gray-100 text-gray-700"
                      }`}
                    >
                      {inning}å›{isMyTeamBatFirst ? "è¡¨" : "è£"}
                      {data?.isCompleted && " âœ“"}
                    </button>
                  );
                }
              )}
            </div>
          </div>
        )}

        {}
        <div className="bg-white rounded-lg shadow">
          <div className="border-b">
            <div className="flex space-x-1 p-4">
              <button
                onClick={() => setActiveTab("batting")}
                className={`px-4 py-2 rounded-lg ${
                  activeTab === "batting"
                    ? "bg-blue-600 text-white"
                    : "bg-gray-200 text-gray-700"
                }`}
              >
                æ‰“æ’ƒè¨˜éŒ²
              </button>
              <button
                onClick={() => setActiveTab("substitution")}
                className={`px-4 py-2 rounded-lg ${
                  activeTab === "substitution"
                    ? "bg-blue-600 text-white"
                    : "bg-gray-200 text-gray-700"
                }`}
              >
                é¸æ‰‹äº¤ä»£
              </button>
              <button
                onClick={() => setActiveTab("pitching")}
                className={`px-4 py-2 rounded-lg ${
                  activeTab === "pitching"
                    ? "bg-blue-600 text-white"
                    : "bg-gray-200 text-gray-700"
                }`}
              >
                æŠ•æ‰‹è¨˜éŒ²
              </button>
              <button
                onClick={() => setActiveTab("stats")}
                className={`px-4 py-2 rounded-lg ${
                  activeTab === "stats"
                    ? "bg-blue-600 text-white"
                    : "bg-gray-200 text-gray-700"
                }`}
              >
                æˆç¸¾è¡¨ç¤º
              </button>
            </div>
          </div>

          {}
          <div className="p-6">
            {activeTab === "batting" && (
              <div className="space-y-6">
                {}
                <RunnerDisplay
                  gameId={gameId}
                  currentInning={selectedInning}
                  refreshTrigger={runnerRefreshTrigger}
                  onRunnerUpdate={async () => {
                    await loadAllInningsData();
                  }}
                />

                <BattingRecordInput
                  gameId={gameId}
                  players={players}
                  currentInning={selectedInning}
                  isTopBottom={selectedTopBottom}
                  canEdit={canEdit}
                  onRecordSaved={async () => {
                    await loadAllInningsData();
                    setRunnerRefreshTrigger((prev) => prev + 1);
                  }}
                  onInningChange={async (newInning, newTopBottom) => {
                    handleInningChange(newInning, newTopBottom);

                    await loadAllInningsData();
                  }}
                  onGameEnd={checkGameEnd}
                />
              </div>
            )}

            {activeTab === "substitution" && (
              <PlayerSubstitution
                gameId={gameId}
                players={players}
                onSubstitution={() => fetchPlayers()}
                canEdit={canEdit}
              />
            )}

            {activeTab === "pitching" && (
              <div className="space-y-4">
                <PitchingRecordInput
                  gameId={gameId}
                  players={players}
                  canEdit={canEdit}
                  onRecordSaved={fetchPlayers}
                />
                <PitchingStatsDisplay gameId={gameId} />
              </div>
            )}

            {activeTab === "stats" && (
              <StatsDisplay gameId={gameId} players={players} />
            )}
          </div>
        </div>
      </div>
    </div>
  );
}


================================================================================
FILE: src/app/games/[gameId]/score/page.tsx
================================================================================

"use client";

import { use, useEffect, useState } from "react";
import { createClientComponentClient } from "@supabase/auth-helpers-nextjs";
import { useAuth } from "@/components/auth/AuthProvider";
import { useRouter } from "next/navigation";
import Link from "next/link";

interface Game {
  id: string;
  name: string;
  game_date: string;
  game_time: string | null;
  location: string | null;
  home_team_id: string | null;
  opponent_name: string;
  status: string;
  home_score: number;
  opponent_score: number;
  created_by: string;
}

interface Team {
  id: string;
  name: string;
}

interface InningScore {
  inning: number;
  top: number | null;
  bottom: number | null;
}

interface PageProps {
  params: Promise<{
    gameId: string;
  }>;
}

export default function ScoreInputPage({ params }: PageProps) {
  const resolvedParams = use(params);
  const gameId = resolvedParams.gameId;

  const [game, setGame] = useState<Game | null>(null);
  const [team, setTeam] = useState<Team | null>(null);
  const [innings, setInnings] = useState<InningScore[]>([]);
  const [loading, setLoading] = useState(true);
  const [saving, setSaving] = useState(false);
  const [canEdit, setCanEdit] = useState(false);
  const [isMyTeamBatFirst, setIsMyTeamBatFirst] = useState(true);

  const { user, loading: authLoading } = useAuth();
  const router = useRouter();
  const supabase = createClientComponentClient();

  useEffect(() => {

    if (authLoading) return;

    if (!user) {
      router.push("/login");
      return;
    }

    if (gameId) {
      fetchGameData();
    }
  }, [gameId, user, authLoading]);

  const fetchGameData = async () => {
    try {

      const { data: gameData, error: gameError } = await supabase
        .from("games")
        .select("*")
        .eq("id", gameId)
        .single();

      if (gameError || !gameData) {
        console.error("è©¦åˆå–å¾—ã‚¨ãƒ©ãƒ¼:", gameError);
        router.push("/games");
        return;
      }

      setGame(gameData);

      if (gameData.home_team_id) {
        const { data: teamData } = await supabase
          .from("teams")
          .select("*")
          .eq("id", gameData.home_team_id)
          .single();

        if (teamData) {
          setTeam(teamData);
        }
      }

      const isOwner = gameData.created_by === user?.id;
      const { data: teamOwner } = await supabase
        .from("teams")
        .select("owner_id")
        .eq("id", gameData.home_team_id)
        .single();

      setCanEdit(isOwner || teamOwner?.owner_id === user?.id);

      const { data: existingScores, error: scoresError } = await supabase
        .from("game_scores")
        .select("*")
        .eq("game_id", gameId)
        .order("inning", { ascending: true });

      if (existingScores && existingScores.length > 0) {

        const maxInning = Math.max(...existingScores.map((s) => s.inning), 7);
        const loadedInnings: InningScore[] = [];

        if (existingScores[0].is_my_team_bat_first !== undefined) {
          setIsMyTeamBatFirst(existingScores[0].is_my_team_bat_first);
        }

        for (let i = 1; i <= maxInning; i++) {
          const existingScore = existingScores.find((s) => s.inning === i);
          loadedInnings.push({
            inning: i,
            top: existingScore?.top_score ?? null,
            bottom: existingScore?.bottom_score ?? null,
          });
        }
        setInnings(loadedInnings);
      } else {

        const initialInnings: InningScore[] = [];
        for (let i = 1; i <= 7; i++) {
          initialInnings.push({
            inning: i,
            top: null,
            bottom: null,
          });
        }
        setInnings(initialInnings);
      }

      if (gameData.status === "scheduled") {
        await updateGameStatus("in_progress");
      }
    } catch (error) {
      console.error("ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼:", error);
    } finally {
      setLoading(false);
    }
  };

  const updateGameStatus = async (status: string) => {
    try {
      const { error } = await supabase
        .from("games")
        .update({
          status: status,
          updated_at: new Date().toISOString(),
        })
        .eq("id", gameId);

      if (!error && game) {
        setGame({ ...game, status });
      }
    } catch (error) {
      console.error("ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°ã‚¨ãƒ©ãƒ¼:", error);
    }
  };

  const handleInningScoreChange = (
    inningIndex: number,
    side: "top" | "bottom",
    value: string
  ) => {
    const newInnings = [...innings];
    const score = value === "" ? null : parseInt(value);

    if (side === "top") {
      newInnings[inningIndex].top = score;
    } else {
      newInnings[inningIndex].bottom = score;
    }

    setInnings(newInnings);
  };

  const calculateTotalScore = (side: "top" | "bottom") => {
    return innings.reduce((total, inning) => {
      const score = side === "top" ? inning.top : inning.bottom;
      return total + (score || 0);
    }, 0);
  };

  const handleSave = async () => {
    if (!canEdit || !game) return;

    setSaving(true);
    try {
      const topTotal = calculateTotalScore("top");
      const bottomTotal = calculateTotalScore("bottom");

      const myTeamScore = isMyTeamBatFirst ? topTotal : bottomTotal;
      const opponentScore = isMyTeamBatFirst ? bottomTotal : topTotal;

      const { error: gameError } = await supabase
        .from("games")
        .update({
          home_score: myTeamScore,
          opponent_score: opponentScore,
          updated_at: new Date().toISOString(),
        })
        .eq("id", gameId);

      if (gameError) {
        throw gameError;
      }

      for (const inning of innings) {
        if (inning.top !== null || inning.bottom !== null) {

          const { error: scoreError } = await supabase
            .from("game_scores")
            .upsert(
              {
                game_id: gameId,
                inning: inning.inning,
                top_score: inning.top || 0,
                bottom_score: inning.bottom || 0,
                is_my_team_bat_first: isMyTeamBatFirst,
                updated_at: new Date().toISOString(),
              },
              {
                onConflict: "game_id,inning",
              }
            );

          if (scoreError) {
            console.error("ã‚¤ãƒ‹ãƒ³ã‚°ã‚¹ã‚³ã‚¢ä¿å­˜ã‚¨ãƒ©ãƒ¼:", scoreError);
          }
        }
      }

      alert("ã‚¹ã‚³ã‚¢ã‚’ä¿å­˜ã—ã¾ã—ãŸ");

      router.push(`/games/${gameId}`);
    } catch (error) {
      console.error("ä¿å­˜ã‚¨ãƒ©ãƒ¼:", error);
      alert("ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ");
    } finally {
      setSaving(false);
    }
  };

  const handleCompleteGame = async () => {
    if (!confirm("è©¦åˆã‚’çµ‚äº†ã—ã¾ã™ã‹ï¼Ÿ")) return;

    setSaving(true);
    try {
      const topTotal = calculateTotalScore("top");
      const bottomTotal = calculateTotalScore("bottom");

      const myTeamScore = isMyTeamBatFirst ? topTotal : bottomTotal;
      const opponentScore = isMyTeamBatFirst ? bottomTotal : topTotal;

      const { error: gameError } = await supabase
        .from("games")
        .update({
          home_score: myTeamScore,
          opponent_score: opponentScore,
          status: "completed",
          updated_at: new Date().toISOString(),
        })
        .eq("id", gameId);

      if (gameError) throw gameError;

      for (const inning of innings) {
        if (inning.top !== null || inning.bottom !== null) {
          const { error: scoreError } = await supabase
            .from("game_scores")
            .upsert(
              {
                game_id: gameId,
                inning: inning.inning,
                top_score: inning.top || 0,
                bottom_score: inning.bottom || 0,
                is_my_team_bat_first: isMyTeamBatFirst,
                updated_at: new Date().toISOString(),
              },
              {
                onConflict: "game_id,inning",
              }
            );

          if (scoreError) {
            console.error("ã‚¤ãƒ‹ãƒ³ã‚°ã‚¹ã‚³ã‚¢ä¿å­˜ã‚¨ãƒ©ãƒ¼:", scoreError);
          }
        }
      }

      alert("è©¦åˆã‚’çµ‚äº†ã—ã¾ã—ãŸ");
      router.push(`/games/${gameId}`);
    } catch (error) {
      console.error("çµ‚äº†å‡¦ç†ã‚¨ãƒ©ãƒ¼:", error);
      alert("çµ‚äº†å‡¦ç†ã«å¤±æ•—ã—ã¾ã—ãŸ");
    } finally {
      setSaving(false);
    }
  };

  const addExtraInning = () => {
    setInnings([
      ...innings,
      {
        inning: innings.length + 1,
        top: null,
        bottom: null,
      },
    ]);
  };

  if (loading) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div>
      </div>
    );
  }

  if (!game || !canEdit) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="text-center">
          <p className="text-gray-600 mb-4">
            {!game ? "è©¦åˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“" : "ã‚¹ã‚³ã‚¢å…¥åŠ›ã®æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“"}
          </p>
          <Link href="/games" className="text-blue-600 hover:text-blue-700">
            è©¦åˆä¸€è¦§ã«æˆ»ã‚‹
          </Link>
        </div>
      </div>
    );
  }

  const topTotal = calculateTotalScore("top");
  const bottomTotal = calculateTotalScore("bottom");
  const myTeamName = team?.name || "ãƒã‚¤ãƒãƒ¼ãƒ ";
  const topTeamName = isMyTeamBatFirst ? myTeamName : game.opponent_name;
  const bottomTeamName = isMyTeamBatFirst ? game.opponent_name : myTeamName;

  return (
    <div className="min-h-screen bg-gray-50 py-8">
      <div className="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
        {}
        <div className="mb-6">
          <Link
            href={`/games/${gameId}`}
            className="inline-flex items-center text-gray-600 hover:text-gray-900 mb-4"
          >
            <svg
              className="w-5 h-5 mr-2"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                strokeLinecap="round"
                strokeLinejoin="round"
                strokeWidth={2}
                d="M15 19l-7-7 7-7"
              />
            </svg>
            è©¦åˆè©³ç´°ã«æˆ»ã‚‹
          </Link>

          <div className="flex justify-between items-center">
            <div>
              <h1 className="text-3xl font-bold text-gray-900">{game.name}</h1>
              <p className="text-gray-600 mt-1">
                {new Date(game.game_date).toLocaleDateString("ja-JP")}
                {game.location && ` @ ${game.location}`}
              </p>
            </div>
            <div className="flex space-x-2">
              <button
                onClick={handleSave}
                disabled={saving}
                className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50"
              >
                {saving ? "ä¿å­˜ä¸­..." : "é€”ä¸­ä¿å­˜"}
              </button>
              <button
                onClick={handleCompleteGame}
                disabled={saving}
                className="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50"
              >
                è©¦åˆçµ‚äº†
              </button>
            </div>
          </div>
        </div>

        {}
        <div className="bg-white rounded-lg shadow p-4 mb-6">
          <div className="flex items-center space-x-4">
            <span className="text-sm font-medium text-gray-700">
              ãƒã‚¤ãƒãƒ¼ãƒ ï¼ˆ{myTeamName}ï¼‰ã¯ï¼š
            </span>
            <div className="flex space-x-2">
              <button
                onClick={() => setIsMyTeamBatFirst(true)}
                className={`px-4 py-2 rounded-lg font-medium transition-colors ${
                  isMyTeamBatFirst
                    ? "bg-blue-600 text-white"
                    : "bg-gray-100 text-gray-700 hover:bg-gray-200"
                }`}
              >
                å…ˆæ”»
              </button>
              <button
                onClick={() => setIsMyTeamBatFirst(false)}
                className={`px-4 py-2 rounded-lg font-medium transition-colors ${
                  !isMyTeamBatFirst
                    ? "bg-blue-600 text-white"
                    : "bg-gray-100 text-gray-700 hover:bg-gray-200"
                }`}
              >
                å¾Œæ”»
              </button>
            </div>
          </div>
        </div>

        {}
        <div className="bg-white rounded-lg shadow-lg overflow-hidden mb-6">
          {}
          <div className="bg-gray-900 text-white p-4">
            <div className="grid grid-cols-3 gap-4 items-center text-center">
              <div>
                <div className="text-sm text-gray-400 mb-1">å…ˆæ”»</div>
                <div className="text-xl font-bold">{topTeamName}</div>
              </div>
              <div className="text-4xl font-bold">
                <span
                  className={topTotal > bottomTotal ? "text-yellow-400" : ""}
                >
                  {topTotal}
                </span>
                <span className="mx-4 text-gray-500">-</span>
                <span
                  className={bottomTotal > topTotal ? "text-yellow-400" : ""}
                >
                  {bottomTotal}
                </span>
              </div>
              <div>
                <div className="text-sm text-gray-400 mb-1">å¾Œæ”»</div>
                <div className="text-xl font-bold">{bottomTeamName}</div>
              </div>
            </div>
          </div>

          {}
          <div className="overflow-x-auto">
            <table className="min-w-full">
              <thead className="bg-gray-100">
                <tr>
                  <th className="px-4 py-2 text-left text-xs font-medium text-gray-600 uppercase">
                    Team
                  </th>
                  {innings.map((inning) => (
                    <th
                      key={inning.inning}
                      className="px-3 py-2 text-center text-xs font-medium text-gray-600"
                    >
                      {inning.inning}
                    </th>
                  ))}
                  <th className="px-4 py-2 text-center text-xs font-medium text-gray-600 uppercase bg-gray-200">
                    è¨ˆ
                  </th>
                </tr>
              </thead>
              <tbody className="divide-y divide-gray-200">
                {}
                <tr>
                  <td className="px-4 py-3 text-sm font-medium text-gray-900 bg-gray-50">
                    <span className="flex items-center">
                      <span className="text-xs text-gray-500 mr-2">å…ˆæ”»</span>
                      {topTeamName}
                      {isMyTeamBatFirst && (
                        <span className="ml-2 text-xs bg-blue-100 text-blue-800 px-2 py-0.5 rounded">
                          è‡ªãƒãƒ¼ãƒ 
                        </span>
                      )}
                    </span>
                  </td>
                  {innings.map((inning, index) => (
                    <td key={`top-${inning.inning}`} className="px-2 py-2">
                      <input
                        type="number"
                        min="0"
                        max="99"
                        value={inning.top ?? ""}
                        onChange={(e) =>
                          handleInningScoreChange(index, "top", e.target.value)
                        }
                        className="w-12 text-center border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
                        disabled={!canEdit}
                      />
                    </td>
                  ))}
                  <td className="px-4 py-3 text-center text-lg font-bold bg-gray-100">
                    {topTotal}
                  </td>
                </tr>

                {}
                <tr>
                  <td className="px-4 py-3 text-sm font-medium text-gray-900 bg-gray-50">
                    <span className="flex items-center">
                      <span className="text-xs text-gray-500 mr-2">å¾Œæ”»</span>
                      {bottomTeamName}
                      {!isMyTeamBatFirst && (
                        <span className="ml-2 text-xs bg-blue-100 text-blue-800 px-2 py-0.5 rounded">
                          è‡ªãƒãƒ¼ãƒ 
                        </span>
                      )}
                    </span>
                  </td>
                  {innings.map((inning, index) => (
                    <td key={`bottom-${inning.inning}`} className="px-2 py-2">
                      <input
                        type="number"
                        min="0"
                        max="99"
                        value={inning.bottom ?? ""}
                        onChange={(e) =>
                          handleInningScoreChange(
                            index,
                            "bottom",
                            e.target.value
                          )
                        }
                        className="w-12 text-center border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
                        disabled={!canEdit}
                      />
                    </td>
                  ))}
                  <td className="px-4 py-3 text-center text-lg font-bold bg-gray-100">
                    {bottomTotal}
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          {}
          {innings.length < 10 && (
            <div className="p-4 border-t bg-gray-50">
              <button
                onClick={addExtraInning}
                className="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"
              >
                å»¶é•·å›ã‚’è¿½åŠ 
              </button>
            </div>
          )}
        </div>

        {}
        <div className="bg-blue-50 border border-blue-200 rounded-lg p-4">
          <div className="flex">
            <svg
              className="w-5 h-5 text-blue-600 mt-0.5 mr-2"
              fill="currentColor"
              viewBox="0 0 20 20"
            >
              <path
                fillRule="evenodd"
                d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"
                clipRule="evenodd"
              />
            </svg>
            <div className="text-sm text-blue-800">
              <p className="font-semibold mb-1">ã‚¹ã‚³ã‚¢å…¥åŠ›ã®ãƒ’ãƒ³ãƒˆ</p>
              <ul className="list-disc list-inside space-y-1">
                <li>ã¾ãšã€ãƒã‚¤ãƒãƒ¼ãƒ ãŒå…ˆæ”»ã‹å¾Œæ”»ã‹ã‚’é¸æŠã—ã¦ãã ã•ã„</li>
                <li>å„ã‚¤ãƒ‹ãƒ³ã‚°ã®å¾—ç‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆåŸºæœ¬7å›åˆ¶ï¼‰</li>
                <li>é€”ä¸­ä¿å­˜ã§é€²è¡ŒçŠ¶æ³ã‚’ä¿å­˜ã§ãã¾ã™</li>
                <li>
                  å»¶é•·æˆ¦ã®å ´åˆã¯ã€Œå»¶é•·å›ã‚’è¿½åŠ ã€ãƒœã‚¿ãƒ³ã§å›ã‚’è¿½åŠ ã§ãã¾ã™ï¼ˆæœ€å¤§10å›ã¾ã§ï¼‰
                </li>
                <li>è©¦åˆçµ‚äº†ãƒœã‚¿ãƒ³ã§è©¦åˆã‚’å®Œäº†çŠ¶æ…‹ã«ã§ãã¾ã™</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}


================================================================================
FILE: src/app/not-found.tsx
================================================================================

import Link from "next/link";

export default function NotFound() {
  return (
    <div className="min-h-screen flex items-center justify-center bg-gray-50">
      <div className="text-center">
        <h1 className="text-6xl font-bold text-gray-900 mb-4">404</h1>
        <h2 className="text-2xl font-semibold text-gray-700 mb-4">
          ãƒšãƒ¼ã‚¸ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“
        </h2>
        <p className="text-gray-600 mb-8">
          ãŠæ¢ã—ã®ãƒšãƒ¼ã‚¸ã¯å­˜åœ¨ã—ãªã„ã‹ã€ç§»å‹•ã—ãŸå¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
        </p>
        <div className="space-x-4">
          <Link
            href="/"
            className="inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
          >
            ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹
          </Link>
          <Link
            href="/dashboard"
            className="inline-flex items-center px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"
          >
            ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã¸
          </Link>
        </div>
      </div>
    </div>
  );
}


================================================================================
FILE: src/components/Header.tsx
================================================================================

"use client";

import Link from "next/link";
import { useAuth } from "@/components/auth/AuthProvider";

export default function Header() {
  const { user, loading, signOut } = useAuth();

  const handleLogout = async () => {
    try {
      await signOut();
    } catch (error) {
      console.error("ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã‚¨ãƒ©ãƒ¼:", error);
      alert("ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸã€‚");
    }
  };

  return (
    <header className="bg-white shadow-sm border-b">
      <nav className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="flex justify-between items-center h-16">
          <div className="flex items-center">
            <Link
              href={user ? "/dashboard" : "/"}
              className="text-xl font-bold text-gray-900 hover:text-gray-700"
            >
              âš¾ï¸ è‰é‡çƒ is Good
            </Link>
          </div>

          <div className="hidden md:flex items-center space-x-8">
            {user && (
              <>
                <Link
                  href="/dashboard"
                  className="text-gray-600 hover:text-gray-900"
                >
                  ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
                </Link>
                <Link
                  href="/teams"
                  className="text-gray-600 hover:text-gray-900"
                >
                  ãƒã‚¤ãƒãƒ¼ãƒ 
                </Link>
                <Link
                  href="/games"
                  className="text-gray-600 hover:text-gray-900"
                >
                  è©¦åˆç®¡ç†
                </Link>
              </>
            )}
            <Link
              href="/search/teams"
              className="text-gray-600 hover:text-gray-900"
            >
              ãƒãƒ¼ãƒ æ¤œç´¢
            </Link>
            <Link
              href="/search/games"
              className="text-gray-600 hover:text-gray-900"
            >
              è©¦åˆæ¤œç´¢
            </Link>
          </div>

          <div className="flex items-center space-x-4">
            {loading ? (
              <div className="text-gray-400">èª­ã¿è¾¼ã¿ä¸­...</div>
            ) : user ? (
              <div className="flex items-center space-x-4">
                <span className="text-sm text-gray-700">{user.email}</span>
                <button
                  onClick={handleLogout}
                  className="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"
                >
                  ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
                </button>
              </div>
            ) : (
              <Link
                href="/login"
                className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
              >
                ãƒ­ã‚°ã‚¤ãƒ³
              </Link>
            )}
          </div>
        </div>
      </nav>
    </header>
  );
}


================================================================================
FILE: src/components/Headline1.tsx
================================================================================

import React from 'react';

interface Headline1Props {
  children: React.ReactNode;
  className?: string;
}

export function Headline1({ children, className = '' }: Headline1Props) {
  return (
    <h1 className={`text-3xl font-bold text-gray-900 mb-6 ${className}`}>
      {children}
    </h1>
  );
}


================================================================================
FILE: src/components/SupabaseProvider.tsx
================================================================================

'use client';

import { createClientComponentClient } from '@supabase/auth-helpers-nextjs';
import { SessionContextProvider } from '@supabase/auth-helpers-react';
import { useState } from 'react';

export default function SupabaseProvider({
  children,
}: {
  children: React.ReactNode;
}) {
  const [supabase] = useState(() => createClientComponentClient());

  return (
    <SessionContextProvider supabaseClient={supabase}>
      {children}
    </SessionContextProvider>
  );
}


================================================================================
FILE: src/components/ui/alert.tsx
================================================================================

import * as React from "react"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const alertVariants = cva(
  "relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",
  {
    variants: {
      variant: {
        default: "bg-background text-foreground",
        destructive:
          "border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

const Alert = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>
>(({ className, variant, ...props }, ref) => (
  <div
    ref={ref}
    role="alert"
    className={cn(alertVariants({ variant }), className)}
    {...props}
  />
))
Alert.displayName = "Alert"

const AlertTitle = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLHeadingElement>
>(({ className, ...props }, ref) => (
  <h5
    ref={ref}
    className={cn("mb-1 font-medium leading-none tracking-tight", className)}
    {...props}
  />
))
AlertTitle.displayName = "AlertTitle"

const AlertDescription = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("text-sm [&_p]:leading-relaxed", className)}
    {...props}
  />
))
AlertDescription.displayName = "AlertDescription"

export { Alert, AlertTitle, AlertDescription }


================================================================================
FILE: src/components/ui/button.tsx
================================================================================

import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const buttonVariants = cva(
  "inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",
  {
    variants: {
      variant: {
        default:
          "bg-primary text-primary-foreground shadow hover:bg-primary/90",
        destructive:
          "bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",
        outline:
          "border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",
        secondary:
          "bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",
        ghost: "hover:bg-accent hover:text-accent-foreground",
        link: "text-primary underline-offset-4 hover:underline",
      },
      size: {
        default: "h-9 px-4 py-2",
        sm: "h-8 rounded-md px-3 text-xs",
        lg: "h-10 rounded-md px-8",
        icon: "h-9 w-9",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  asChild?: boolean
}

const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant, size, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : "button"
    return (
      <Comp
        className={cn(buttonVariants({ variant, size, className }))}
        ref={ref}
        {...props}
      />
    )
  }
)
Button.displayName = "Button"

export { Button, buttonVariants }


================================================================================
FILE: src/components/ui/card.tsx
================================================================================

import * as React from "react"

import { cn } from "@/lib/utils"

const Card = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn(
      "rounded-xl border bg-card text-card-foreground shadow",
      className
    )}
    {...props}
  />
))
Card.displayName = "Card"

const CardHeader = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("flex flex-col space-y-1.5 p-6", className)}
    {...props}
  />
))
CardHeader.displayName = "CardHeader"

const CardTitle = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("font-semibold leading-none tracking-tight", className)}
    {...props}
  />
))
CardTitle.displayName = "CardTitle"

const CardDescription = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("text-sm text-muted-foreground", className)}
    {...props}
  />
))
CardDescription.displayName = "CardDescription"

const CardContent = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn("p-6 pt-0", className)} {...props} />
))
CardContent.displayName = "CardContent"

const CardFooter = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("flex items-center p-6 pt-0", className)}
    {...props}
  />
))
CardFooter.displayName = "CardFooter"

export { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }


================================================================================
FILE: src/components/ui/input.tsx
================================================================================

import * as React from "react"

import { cn } from "@/lib/utils"

const Input = React.forwardRef<HTMLInputElement, React.ComponentProps<"input">>(
  ({ className, type, ...props }, ref) => {
    return (
      <input
        type={type}
        className={cn(
          "flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
          className
        )}
        ref={ref}
        {...props}
      />
    )
  }
)
Input.displayName = "Input"

export { Input }


================================================================================
FILE: src/components/ui/label.tsx
================================================================================

"use client"

import * as React from "react"
import * as LabelPrimitive from "@radix-ui/react-label"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const labelVariants = cva(
  "text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
)

const Label = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &
    VariantProps<typeof labelVariants>
>(({ className, ...props }, ref) => (
  <LabelPrimitive.Root
    ref={ref}
    className={cn(labelVariants(), className)}
    {...props}
  />
))
Label.displayName = LabelPrimitive.Root.displayName

export { Label }


================================================================================
FILE: src/components/ui/select.tsx
================================================================================

"use client"

import * as React from "react"
import * as SelectPrimitive from "@radix-ui/react-select"
import { Check, ChevronDown, ChevronUp } from "lucide-react"

import { cn } from "@/lib/utils"

const Select = SelectPrimitive.Root

const SelectGroup = SelectPrimitive.Group

const SelectValue = SelectPrimitive.Value

const SelectTrigger = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Trigger
    ref={ref}
    className={cn(
      "flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",
      className
    )}
    {...props}
  >
    {children}
    <SelectPrimitive.Icon asChild>
      <ChevronDown className="h-4 w-4 opacity-50" />
    </SelectPrimitive.Icon>
  </SelectPrimitive.Trigger>
))
SelectTrigger.displayName = SelectPrimitive.Trigger.displayName

const SelectScrollUpButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollUpButton
    ref={ref}
    className={cn(
      "flex cursor-default items-center justify-center py-1",
      className
    )}
    {...props}
  >
    <ChevronUp className="h-4 w-4" />
  </SelectPrimitive.ScrollUpButton>
))
SelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName

const SelectScrollDownButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollDownButton
    ref={ref}
    className={cn(
      "flex cursor-default items-center justify-center py-1",
      className
    )}
    {...props}
  >
    <ChevronDown className="h-4 w-4" />
  </SelectPrimitive.ScrollDownButton>
))
SelectScrollDownButton.displayName =
  SelectPrimitive.ScrollDownButton.displayName

const SelectContent = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>
>(({ className, children, position = "popper", ...props }, ref) => (
  <SelectPrimitive.Portal>
    <SelectPrimitive.Content
      ref={ref}
      className={cn(
        "relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",
        position === "popper" &&
          "data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",
        className
      )}
      position={position}
      {...props}
    >
      <SelectScrollUpButton />
      <SelectPrimitive.Viewport
        className={cn(
          "p-1",
          position === "popper" &&
            "h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"
        )}
      >
        {children}
      </SelectPrimitive.Viewport>
      <SelectScrollDownButton />
    </SelectPrimitive.Content>
  </SelectPrimitive.Portal>
))
SelectContent.displayName = SelectPrimitive.Content.displayName

const SelectLabel = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Label
    ref={ref}
    className={cn("px-2 py-1.5 text-sm font-semibold", className)}
    {...props}
  />
))
SelectLabel.displayName = SelectPrimitive.Label.displayName

const SelectItem = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    {...props}
  >
    <span className="absolute right-2 flex h-3.5 w-3.5 items-center justify-center">
      <SelectPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </SelectPrimitive.ItemIndicator>
    </span>
    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
  </SelectPrimitive.Item>
))
SelectItem.displayName = SelectPrimitive.Item.displayName

const SelectSeparator = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Separator
    ref={ref}
    className={cn("-mx-1 my-1 h-px bg-muted", className)}
    {...props}
  />
))
SelectSeparator.displayName = SelectPrimitive.Separator.displayName

export {
  Select,
  SelectGroup,
  SelectValue,
  SelectTrigger,
  SelectContent,
  SelectLabel,
  SelectItem,
  SelectSeparator,
  SelectScrollUpButton,
  SelectScrollDownButton,
}


================================================================================
FILE: src/lib/game-logic.ts
================================================================================

import { SupabaseClient } from '@supabase/supabase-js';

export async function advanceRunners(
  supabase: SupabaseClient,
  gameId: string,
  inning: number,
  batterBaseReached: number,
  batterId: string
) {
  if (batterBaseReached <= 0) return;

  const { data: currentRunners } = await supabase
    .from("game_runners")
    .select("*")
    .eq("game_id", gameId)
    .eq("inning", inning)
    .eq("is_active", true)
    .order("current_base", { ascending: false });

  if (!currentRunners || currentRunners.length === 0) return;

  const basesOccupied = new Set(currentRunners.map((r) => r.current_base));

  for (const runner of currentRunners) {
    let newBase = runner.current_base;

    if (batterBaseReached === 1) {
      if (runner.current_base === 1) {
        newBase = 2;
      } else if (runner.current_base === 2 && basesOccupied.has(1)) {
        newBase = 3;
      } else if (
        runner.current_base === 3 &&
        basesOccupied.has(2) &&
        basesOccupied.has(1)
      ) {
        newBase = 4;
      }
    } else if (batterBaseReached === 2) {
      newBase = Math.min(runner.current_base + 2, 4);
    } else if (batterBaseReached === 3) {
      newBase = 4;
    } else if (batterBaseReached === 4) {
      newBase = 4;
    }

    if (newBase !== runner.current_base) {
      if (newBase === 4) {
        await supabase
          .from("game_runners")
          .update({ current_base: 4, is_active: false })
          .eq("id", runner.id);

        await supabase
          .from("game_batting_records")
          .update({ run_scored: true })
          .eq("game_id", gameId)
          .eq("player_id", runner.player_id)
          .eq("inning", inning);
      } else {
        await supabase
          .from("game_runners")
          .update({ current_base: newBase })
          .eq("id", runner.id);
      }
    }
  }
}

export function calculateBaseReached(result: string): number {
  const baseReachedMap: Record<string, number> = {
    "å®‰æ‰“": 1,
    "äºŒå¡æ‰“": 2,
    "ä¸‰å¡æ‰“": 3,
    "æœ¬å¡æ‰“": 4,
    "å››çƒ": 1,
    "æ­»çƒ": 1,
    "ã‚¨ãƒ©ãƒ¼": 1,
    "é‡é¸": 1,
    "ä¸‰æŒ¯": 0,
    "ã‚´ãƒ­": 0,
    "ãƒ•ãƒ©ã‚¤": 0,
    "ãƒ©ã‚¤ãƒŠãƒ¼": 0,
    "çŠ æ‰“": 0,
    "çŠ é£›": 0,
    "ãƒ•ã‚£ãƒ¼ãƒ«ãƒ€ãƒ¼ã‚¹ãƒãƒ§ã‚¤ã‚¹": 0,
  };

  return baseReachedMap[result] || 0;
}

export function isOutResult(result: string): boolean {
  const outResults = [
    "ä¸‰æŒ¯", "ã‚´ãƒ­", "ãƒ•ãƒ©ã‚¤", "ãƒ©ã‚¤ãƒŠãƒ¼",
    "çŠ æ‰“", "çŠ é£›", "ãƒ•ã‚£ãƒ¼ãƒ«ãƒ€ãƒ¼ã‚¹ãƒãƒ§ã‚¤ã‚¹"
  ];
  return outResults.includes(result);
}


================================================================================
FILE: src/lib/japanData.ts
================================================================================

export const prefectures = [
  "åŒ—æµ·é“", "é’æ£®çœŒ", "å²©æ‰‹çœŒ", "å®®åŸçœŒ", "ç§‹ç”°çœŒ", "å±±å½¢çœŒ", "ç¦å³¶çœŒ",
  "èŒ¨åŸçœŒ", "æ ƒæœ¨çœŒ", "ç¾¤é¦¬çœŒ", "åŸ¼ç‰çœŒ", "åƒè‘‰çœŒ", "æ±äº¬éƒ½", "ç¥å¥ˆå·çœŒ",
  "æ–°æ½ŸçœŒ", "å¯Œå±±çœŒ", "çŸ³å·çœŒ", "ç¦äº•çœŒ", "å±±æ¢¨çœŒ", "é•·é‡çœŒ", "å²é˜œçœŒ",
  "é™å²¡çœŒ", "æ„›çŸ¥çœŒ", "ä¸‰é‡çœŒ", "æ»‹è³€çœŒ", "äº¬éƒ½åºœ", "å¤§é˜ªåºœ", "å…µåº«çœŒ",
  "å¥ˆè‰¯çœŒ", "å’Œæ­Œå±±çœŒ", "é³¥å–çœŒ", "å³¶æ ¹çœŒ", "å²¡å±±çœŒ", "åºƒå³¶çœŒ", "å±±å£çœŒ",
  "å¾³å³¶çœŒ", "é¦™å·çœŒ", "æ„›åª›çœŒ", "é«˜çŸ¥çœŒ", "ç¦å²¡çœŒ", "ä½è³€çœŒ", "é•·å´çœŒ",
  "ç†Šæœ¬çœŒ", "å¤§åˆ†çœŒ", "å®®å´çœŒ", "é¹¿å…å³¶çœŒ", "æ²–ç¸„çœŒ"
];

export const cities: { [key: string]: string[] } = {
  "åŒ—æµ·é“": ["æœ­å¹Œå¸‚", "å‡½é¤¨å¸‚", "å°æ¨½å¸‚", "æ—­å·å¸‚", "å®¤è˜­å¸‚", "é‡§è·¯å¸‚", "å¸¯åºƒå¸‚", "åŒ—è¦‹å¸‚", "å¤•å¼µå¸‚", "å²©è¦‹æ²¢å¸‚", "ç¶²èµ°å¸‚", "ç•™èŒå¸‚", "è‹«å°ç‰§å¸‚", "ç¨šå†…å¸‚", "ç¾å”„å¸‚", "èŠ¦åˆ¥å¸‚", "æ±Ÿåˆ¥å¸‚", "èµ¤å¹³å¸‚", "ç´‹åˆ¥å¸‚", "å£«åˆ¥å¸‚", "åå¯„å¸‚", "ä¸‰ç¬ å¸‚", "æ ¹å®¤å¸‚", "åƒæ­³å¸‚", "æ»å·å¸‚", "ç ‚å·å¸‚", "æ­Œå¿—å†…å¸‚", "æ·±å·å¸‚", "å¯Œè‰¯é‡å¸‚", "ç™»åˆ¥å¸‚", "æµåº­å¸‚", "ä¼Šé”å¸‚", "åŒ—åºƒå³¶å¸‚", "çŸ³ç‹©å¸‚", "åŒ—æ–—å¸‚"],
  "é’æ£®çœŒ": ["é’æ£®å¸‚", "å¼˜å‰å¸‚", "å…«æˆ¸å¸‚", "é»’çŸ³å¸‚", "äº”æ‰€å·åŸå¸‚", "åå’Œç”°å¸‚", "ä¸‰æ²¢å¸‚", "ã‚€ã¤å¸‚", "ã¤ãŒã‚‹å¸‚", "å¹³å·å¸‚"],
  "å²©æ‰‹çœŒ": ["ç››å²¡å¸‚", "å®®å¤å¸‚", "å¤§èˆ¹æ¸¡å¸‚", "èŠ±å·»å¸‚", "åŒ—ä¸Šå¸‚", "ä¹…æ…ˆå¸‚", "é é‡å¸‚", "ä¸€é–¢å¸‚", "é™¸å‰é«˜ç”°å¸‚", "é‡œçŸ³å¸‚", "äºŒæˆ¸å¸‚", "å…«å¹¡å¹³å¸‚", "å¥¥å·å¸‚", "æ»æ²¢å¸‚"],
  "å®®åŸçœŒ": ["ä»™å°å¸‚", "çŸ³å·»å¸‚", "å¡©ç«ˆå¸‚", "æ°—ä»™æ²¼å¸‚", "ç™½çŸ³å¸‚", "åå–å¸‚", "è§’ç”°å¸‚", "å¤šè³€åŸå¸‚", "å²©æ²¼å¸‚", "ç™»ç±³å¸‚", "æ —åŸå¸‚", "æ±æ¾å³¶å¸‚", "å¤§å´å¸‚", "å¯Œè°·å¸‚"],
  "ç§‹ç”°çœŒ": ["ç§‹ç”°å¸‚", "èƒ½ä»£å¸‚", "æ¨ªæ‰‹å¸‚", "å¤§é¤¨å¸‚", "ç”·é¹¿å¸‚", "æ¹¯æ²¢å¸‚", "é¹¿è§’å¸‚", "ç”±åˆ©æœ¬è˜å¸‚", "æ½Ÿä¸Šå¸‚", "å¤§ä»™å¸‚", "åŒ—ç§‹ç”°å¸‚", "ã«ã‹ã»å¸‚", "ä»™åŒ—å¸‚"],
  "å±±å½¢çœŒ": ["å±±å½¢å¸‚", "ç±³æ²¢å¸‚", "é¶´å²¡å¸‚", "é…’ç”°å¸‚", "æ–°åº„å¸‚", "å¯’æ²³æ±Ÿå¸‚", "ä¸Šå±±å¸‚", "æ‘å±±å¸‚", "é•·äº•å¸‚", "å¤©ç«¥å¸‚", "æ±æ ¹å¸‚", "å°¾èŠ±æ²¢å¸‚", "å—é™½å¸‚"],
  "ç¦å³¶çœŒ": ["ç¦å³¶å¸‚", "ä¼šæ´¥è‹¥æ¾å¸‚", "éƒ¡å±±å¸‚", "ã„ã‚ãå¸‚", "ç™½æ²³å¸‚", "é ˆè³€å·å¸‚", "å–œå¤šæ–¹å¸‚", "ç›¸é¦¬å¸‚", "äºŒæœ¬æ¾å¸‚", "ç”°æ‘å¸‚", "å—ç›¸é¦¬å¸‚", "ä¼Šé”å¸‚", "æœ¬å®®å¸‚"],
  "èŒ¨åŸçœŒ": ["æ°´æˆ¸å¸‚", "æ—¥ç«‹å¸‚", "åœŸæµ¦å¸‚", "å¤æ²³å¸‚", "çŸ³å²¡å¸‚", "çµåŸå¸‚", "é¾ã‚±å´å¸‚", "ä¸‹å¦»å¸‚", "å¸¸ç·å¸‚", "å¸¸é™¸å¤ªç”°å¸‚", "é«˜è©å¸‚", "åŒ—èŒ¨åŸå¸‚", "ç¬ é–“å¸‚", "å–æ‰‹å¸‚", "ç‰›ä¹…å¸‚", "ã¤ãã°å¸‚", "ã²ãŸã¡ãªã‹å¸‚", "é¹¿å¶‹å¸‚", "æ½®æ¥å¸‚", "å®ˆè°·å¸‚", "å¸¸é™¸å¤§å®®å¸‚", "é‚£ç‚å¸‚", "ç­‘è¥¿å¸‚", "å‚æ±å¸‚", "ç¨²æ•·å¸‚", "ã‹ã™ã¿ãŒã†ã‚‰å¸‚", "æ¡œå·å¸‚", "ç¥æ –å¸‚", "è¡Œæ–¹å¸‚", "é‰¾ç”°å¸‚", "ã¤ãã°ã¿ã‚‰ã„å¸‚", "å°ç¾ç‰å¸‚"],
  "æ ƒæœ¨çœŒ": ["å®‡éƒ½å®®å¸‚", "è¶³åˆ©å¸‚", "æ ƒæœ¨å¸‚", "ä½é‡å¸‚", "é¹¿æ²¼å¸‚", "æ—¥å…‰å¸‚", "å°å±±å¸‚", "çœŸå²¡å¸‚", "å¤§ç”°åŸå¸‚", "çŸ¢æ¿å¸‚", "é‚£é ˆå¡©åŸå¸‚", "ã•ãã‚‰å¸‚", "é‚£é ˆçƒå±±å¸‚", "ä¸‹é‡å¸‚"],
  "ç¾¤é¦¬çœŒ": ["å‰æ©‹å¸‚", "é«˜å´å¸‚", "æ¡ç”Ÿå¸‚", "ä¼Šå‹¢å´å¸‚", "å¤ªç”°å¸‚", "æ²¼ç”°å¸‚", "é¤¨æ—å¸‚", "æ¸‹å·å¸‚", "è—¤å²¡å¸‚", "å¯Œå²¡å¸‚", "å®‰ä¸­å¸‚", "ã¿ã©ã‚Šå¸‚"],
  "åŸ¼ç‰çœŒ": ["ã•ã„ãŸã¾å¸‚", "å·è¶Šå¸‚", "ç†Šè°·å¸‚", "å·å£å¸‚", "è¡Œç”°å¸‚", "ç§©çˆ¶å¸‚", "æ‰€æ²¢å¸‚", "é£¯èƒ½å¸‚", "åŠ é ˆå¸‚", "æœ¬åº„å¸‚", "æ±æ¾å±±å¸‚", "æ˜¥æ—¥éƒ¨å¸‚", "ç‹­å±±å¸‚", "ç¾½ç”Ÿå¸‚", "é´»å·£å¸‚", "æ·±è°·å¸‚", "ä¸Šå°¾å¸‚", "è‰åŠ å¸‚", "è¶Šè°·å¸‚", "è•¨å¸‚", "æˆ¸ç”°å¸‚", "å…¥é–“å¸‚", "æœéœå¸‚", "å¿—æœ¨å¸‚", "å’Œå…‰å¸‚", "æ–°åº§å¸‚", "æ¡¶å·å¸‚", "ä¹…å–œå¸‚", "åŒ—æœ¬å¸‚", "å…«æ½®å¸‚", "å¯Œå£«è¦‹å¸‚", "ä¸‰éƒ·å¸‚", "è“®ç”°å¸‚", "å‚æˆ¸å¸‚", "å¹¸æ‰‹å¸‚", "é¶´ãƒ¶å³¶å¸‚", "æ—¥é«˜å¸‚", "å‰å·å¸‚", "ãµã˜ã¿é‡å¸‚", "ç™½å²¡å¸‚"],
  "åƒè‘‰çœŒ": ["åƒè‘‰å¸‚", "éŠšå­å¸‚", "å¸‚å·å¸‚", "èˆ¹æ©‹å¸‚", "é¤¨å±±å¸‚", "æœ¨æ›´æ´¥å¸‚", "æ¾æˆ¸å¸‚", "é‡ç”°å¸‚", "èŒ‚åŸå¸‚", "æˆç”°å¸‚", "ä½å€‰å¸‚", "æ±é‡‘å¸‚", "æ—­å¸‚", "ç¿’å¿—é‡å¸‚", "æŸå¸‚", "å‹æµ¦å¸‚", "å¸‚åŸå¸‚", "æµå±±å¸‚", "å…«åƒä»£å¸‚", "æˆ‘å­«å­å¸‚", "é´¨å·å¸‚", "éŒã‚±è°·å¸‚", "å›æ´¥å¸‚", "å¯Œæ´¥å¸‚", "æµ¦å®‰å¸‚", "å››è¡—é“å¸‚", "è¢–ã‚±æµ¦å¸‚", "å…«è¡—å¸‚", "å°è¥¿å¸‚", "ç™½äº•å¸‚", "å¯Œé‡Œå¸‚", "å—æˆ¿ç·å¸‚", "åŒç‘³å¸‚", "é¦™å–å¸‚", "å±±æ­¦å¸‚", "ã„ã™ã¿å¸‚", "å¤§ç¶²ç™½é‡Œå¸‚"],
  "æ±äº¬éƒ½": ["åƒä»£ç”°åŒº", "ä¸­å¤®åŒº", "æ¸¯åŒº", "æ–°å®¿åŒº", "æ–‡äº¬åŒº", "å°æ±åŒº", "å¢¨ç”°åŒº", "æ±Ÿæ±åŒº", "å“å·åŒº", "ç›®é»’åŒº", "å¤§ç”°åŒº", "ä¸–ç”°è°·åŒº", "æ¸‹è°·åŒº", "ä¸­é‡åŒº", "æ‰ä¸¦åŒº", "è±Šå³¶åŒº", "åŒ—åŒº", "è’å·åŒº", "æ¿æ©‹åŒº", "ç·´é¦¬åŒº", "è¶³ç«‹åŒº", "è‘›é£¾åŒº", "æ±Ÿæˆ¸å·åŒº", "å…«ç‹å­å¸‚", "ç«‹å·å¸‚", "æ­¦è”µé‡å¸‚", "ä¸‰é·¹å¸‚", "é’æ¢…å¸‚", "åºœä¸­å¸‚", "æ˜­å³¶å¸‚", "èª¿å¸ƒå¸‚", "ç”ºç”°å¸‚", "å°é‡‘äº•å¸‚", "å°å¹³å¸‚", "æ—¥é‡å¸‚", "æ±æ‘å±±å¸‚", "å›½åˆ†å¯ºå¸‚", "å›½ç«‹å¸‚", "ç¦ç”Ÿå¸‚", "ç‹›æ±Ÿå¸‚", "æ±å¤§å’Œå¸‚", "æ¸…ç€¬å¸‚", "æ±ä¹…ç•™ç±³å¸‚", "æ­¦è”µæ‘å±±å¸‚", "å¤šæ‘©å¸‚", "ç¨²åŸå¸‚", "ç¾½æ‘å¸‚", "ã‚ãã‚‹é‡å¸‚", "è¥¿æ±äº¬å¸‚"],
  "ç¥å¥ˆå·çœŒ": ["æ¨ªæµœå¸‚", "å·å´å¸‚", "ç›¸æ¨¡åŸå¸‚", "æ¨ªé ˆè³€å¸‚", "å¹³å¡šå¸‚", "éŒå€‰å¸‚", "è—¤æ²¢å¸‚", "å°ç”°åŸå¸‚", "èŒ…ãƒ¶å´å¸‚", "é€—å­å¸‚", "ä¸‰æµ¦å¸‚", "ç§¦é‡å¸‚", "åšæœ¨å¸‚", "å¤§å’Œå¸‚", "ä¼Šå‹¢åŸå¸‚", "æµ·è€åå¸‚", "åº§é–“å¸‚", "å—è¶³æŸ„å¸‚", "ç¶¾ç€¬å¸‚"],
  "æ–°æ½ŸçœŒ": ["æ–°æ½Ÿå¸‚", "é•·å²¡å¸‚", "ä¸‰æ¡å¸‚", "æŸå´å¸‚", "æ–°ç™ºç”°å¸‚", "å°åƒè°·å¸‚", "åŠ èŒ‚å¸‚", "åæ—¥ç”ºå¸‚", "è¦‹é™„å¸‚", "æ‘ä¸Šå¸‚", "ç‡•å¸‚", "ç³¸é­šå·å¸‚", "å¦™é«˜å¸‚", "äº”æ³‰å¸‚", "ä¸Šè¶Šå¸‚", "é˜¿è³€é‡å¸‚", "ä½æ¸¡å¸‚", "é­šæ²¼å¸‚", "å—é­šæ²¼å¸‚", "èƒå†…å¸‚"],
  "å¯Œå±±çœŒ": ["å¯Œå±±å¸‚", "é«˜å²¡å¸‚", "é­šæ´¥å¸‚", "æ°·è¦‹å¸‚", "æ»‘å·å¸‚", "é»’éƒ¨å¸‚", "ç ºæ³¢å¸‚", "å°çŸ¢éƒ¨å¸‚", "å—ç ºå¸‚", "å°„æ°´å¸‚"],
  "çŸ³å·çœŒ": ["é‡‘æ²¢å¸‚", "ä¸ƒå°¾å¸‚", "å°æ¾å¸‚", "è¼ªå³¶å¸‚", "ç æ´²å¸‚", "åŠ è³€å¸‚", "ç¾½å’‹å¸‚", "ã‹ã»ãå¸‚", "ç™½å±±å¸‚", "èƒ½ç¾å¸‚", "é‡ã€…å¸‚å¸‚"],
  "ç¦äº•çœŒ": ["ç¦äº•å¸‚", "æ•¦è³€å¸‚", "å°æµœå¸‚", "å¤§é‡å¸‚", "å‹å±±å¸‚", "é¯–æ±Ÿå¸‚", "ã‚ã‚ã‚‰å¸‚", "è¶Šå‰å¸‚", "å‚äº•å¸‚"],
  "å±±æ¢¨çœŒ": ["ç”²åºœå¸‚", "å¯Œå£«å‰ç”°å¸‚", "éƒ½ç•™å¸‚", "å±±æ¢¨å¸‚", "å¤§æœˆå¸‚", "éŸ®å´å¸‚", "å—ã‚¢ãƒ«ãƒ—ã‚¹å¸‚", "åŒ—æœå¸‚", "ç”²æ–å¸‚", "ç¬›å¹å¸‚", "ä¸Šé‡åŸå¸‚", "ç”²å·å¸‚", "ä¸­å¤®å¸‚"],
  "é•·é‡çœŒ": ["é•·é‡å¸‚", "æ¾æœ¬å¸‚", "ä¸Šç”°å¸‚", "å²¡è°·å¸‚", "é£¯ç”°å¸‚", "è«è¨ªå¸‚", "é ˆå‚å¸‚", "å°è«¸å¸‚", "ä¼Šé‚£å¸‚", "é§’ãƒ¶æ ¹å¸‚", "ä¸­é‡å¸‚", "å¤§ç”ºå¸‚", "é£¯å±±å¸‚", "èŒ…é‡å¸‚", "å¡©å°»å¸‚", "ä½ä¹…å¸‚", "åƒæ›²å¸‚", "æ±å¾¡å¸‚", "å®‰æ›‡é‡å¸‚"],
  "å²é˜œçœŒ": ["å²é˜œå¸‚", "å¤§å£å¸‚", "é«˜å±±å¸‚", "å¤šæ²»è¦‹å¸‚", "é–¢å¸‚", "ä¸­æ´¥å·å¸‚", "ç¾æ¿ƒå¸‚", "ç‘æµªå¸‚", "ç¾½å³¶å¸‚", "æµé‚£å¸‚", "ç¾æ¿ƒåŠ èŒ‚å¸‚", "åœŸå²å¸‚", "å„å‹™åŸå¸‚", "å¯å…å¸‚", "å±±çœŒå¸‚", "ç‘ç©‚å¸‚", "é£›é¨¨å¸‚", "æœ¬å·£å¸‚", "éƒ¡ä¸Šå¸‚", "ä¸‹å‘‚å¸‚", "æµ·æ´¥å¸‚"],
  "é™å²¡çœŒ": ["é™å²¡å¸‚", "æµœæ¾å¸‚", "æ²¼æ´¥å¸‚", "ç†±æµ·å¸‚", "ä¸‰å³¶å¸‚", "å¯Œå£«å®®å¸‚", "ä¼Šæ±å¸‚", "å³¶ç”°å¸‚", "å¯Œå£«å¸‚", "ç£ç”°å¸‚", "ç„¼æ´¥å¸‚", "æ›å·å¸‚", "è—¤æå¸‚", "å¾¡æ®¿å ´å¸‚", "è¢‹äº•å¸‚", "ä¸‹ç”°å¸‚", "è£¾é‡å¸‚", "æ¹–è¥¿å¸‚", "ä¼Šè±†å¸‚", "å¾¡å‰å´å¸‚", "èŠå·å¸‚", "ä¼Šè±†ã®å›½å¸‚", "ç‰§ä¹‹åŸå¸‚"],
  "æ„›çŸ¥çœŒ": ["åå¤å±‹å¸‚", "è±Šæ©‹å¸‚", "å²¡å´å¸‚", "ä¸€å®®å¸‚", "ç€¬æˆ¸å¸‚", "åŠç”°å¸‚", "æ˜¥æ—¥äº•å¸‚", "è±Šå·å¸‚", "æ´¥å³¶å¸‚", "ç¢§å—å¸‚", "åˆˆè°·å¸‚", "è±Šç”°å¸‚", "å®‰åŸå¸‚", "è¥¿å°¾å¸‚", "è’²éƒ¡å¸‚", "çŠ¬å±±å¸‚", "å¸¸æ»‘å¸‚", "æ±Ÿå—å¸‚", "å°ç‰§å¸‚", "ç¨²æ²¢å¸‚", "æ–°åŸå¸‚", "æ±æµ·å¸‚", "å¤§åºœå¸‚", "çŸ¥å¤šå¸‚", "çŸ¥ç«‹å¸‚", "å°¾å¼µæ—­å¸‚", "é«˜æµœå¸‚", "å²©å€‰å¸‚", "è±Šæ˜å¸‚", "æ—¥é€²å¸‚", "ç”°åŸå¸‚", "æ„›è¥¿å¸‚", "æ¸…é ˆå¸‚", "åŒ—åå¤å±‹å¸‚", "å¼¥å¯Œå¸‚", "ã¿ã‚ˆã—å¸‚", "ã‚ã¾å¸‚", "é•·ä¹…æ‰‹å¸‚"],
  "ä¸‰é‡çœŒ": ["æ´¥å¸‚", "å››æ—¥å¸‚å¸‚", "ä¼Šå‹¢å¸‚", "æ¾é˜ªå¸‚", "æ¡‘åå¸‚", "éˆ´é¹¿å¸‚", "åå¼µå¸‚", "å°¾é·²å¸‚", "äº€å±±å¸‚", "é³¥ç¾½å¸‚", "ç†Šé‡å¸‚", "ã„ãªã¹å¸‚", "å¿—æ‘©å¸‚", "ä¼Šè³€å¸‚"],
  "æ»‹è³€çœŒ": ["å¤§æ´¥å¸‚", "å½¦æ ¹å¸‚", "é•·æµœå¸‚", "è¿‘æ±Ÿå…«å¹¡å¸‚", "è‰æ´¥å¸‚", "å®ˆå±±å¸‚", "æ —æ±å¸‚", "ç”²è³€å¸‚", "é‡æ´²å¸‚", "æ¹–å—å¸‚", "é«˜å³¶å¸‚", "æ±è¿‘æ±Ÿå¸‚", "ç±³åŸå¸‚"],
  "äº¬éƒ½åºœ": ["äº¬éƒ½å¸‚", "ç¦çŸ¥å±±å¸‚", "èˆé¶´å¸‚", "ç¶¾éƒ¨å¸‚", "å®‡æ²»å¸‚", "å®®æ´¥å¸‚", "äº€å²¡å¸‚", "åŸé™½å¸‚", "å‘æ—¥å¸‚", "é•·å²¡äº¬å¸‚", "å…«å¹¡å¸‚", "äº¬ç”°è¾ºå¸‚", "äº¬ä¸¹å¾Œå¸‚", "å—ä¸¹å¸‚", "æœ¨æ´¥å·å¸‚"],
  "å¤§é˜ªåºœ": ["å¤§é˜ªå¸‚", "å ºå¸‚", "å²¸å’Œç”°å¸‚", "è±Šä¸­å¸‚", "æ± ç”°å¸‚", "å¹ç”°å¸‚", "æ³‰å¤§æ´¥å¸‚", "é«˜æ§»å¸‚", "è²å¡šå¸‚", "å®ˆå£å¸‚", "æšæ–¹å¸‚", "èŒ¨æœ¨å¸‚", "å…«å°¾å¸‚", "æ³‰ä½é‡å¸‚", "å¯Œç”°æ—å¸‚", "å¯å±‹å·å¸‚", "æ²³å†…é•·é‡å¸‚", "æ¾åŸå¸‚", "å¤§æ±å¸‚", "å’Œæ³‰å¸‚", "ç®•é¢å¸‚", "æŸåŸå¸‚", "ç¾½æ›³é‡å¸‚", "é–€çœŸå¸‚", "æ‘‚æ´¥å¸‚", "é«˜çŸ³å¸‚", "è—¤äº•å¯ºå¸‚", "æ±å¤§é˜ªå¸‚", "æ³‰å—å¸‚", "å››æ¢ç•·å¸‚", "äº¤é‡å¸‚", "å¤§é˜ªç‹­å±±å¸‚", "é˜ªå—å¸‚"],
  "å…µåº«çœŒ": ["ç¥æˆ¸å¸‚", "å§«è·¯å¸‚", "å°¼å´å¸‚", "æ˜çŸ³å¸‚", "è¥¿å®®å¸‚", "æ´²æœ¬å¸‚", "èŠ¦å±‹å¸‚", "ä¼Šä¸¹å¸‚", "ç›¸ç”Ÿå¸‚", "è±Šå²¡å¸‚", "åŠ å¤å·å¸‚", "èµ¤ç©‚å¸‚", "è¥¿è„‡å¸‚", "å®å¡šå¸‚", "ä¸‰æœ¨å¸‚", "é«˜ç ‚å¸‚", "å·è¥¿å¸‚", "å°é‡å¸‚", "ä¸‰ç”°å¸‚", "åŠ è¥¿å¸‚", "ä¸¹æ³¢ç¯ å±±å¸‚", "é¤Šçˆ¶å¸‚", "ä¸¹æ³¢å¸‚", "å—ã‚ã‚ã˜å¸‚", "æœæ¥å¸‚", "æ·¡è·¯å¸‚", "å®ç²Ÿå¸‚", "åŠ æ±å¸‚", "ãŸã¤ã®å¸‚"],
  "å¥ˆè‰¯çœŒ": ["å¥ˆè‰¯å¸‚", "å¤§å’Œé«˜ç”°å¸‚", "å¤§å’Œéƒ¡å±±å¸‚", "å¤©ç†å¸‚", "æ©¿åŸå¸‚", "æ¡œäº•å¸‚", "äº”æ¢å¸‚", "å¾¡æ‰€å¸‚", "ç”Ÿé§’å¸‚", "é¦™èŠå¸‚", "è‘›åŸå¸‚", "å®‡é™€å¸‚"],
  "å’Œæ­Œå±±çœŒ": ["å’Œæ­Œå±±å¸‚", "æµ·å—å¸‚", "æ©‹æœ¬å¸‚", "æœ‰ç”°å¸‚", "å¾¡åŠå¸‚", "ç”°è¾ºå¸‚", "æ–°å®®å¸‚", "ç´€ã®å·å¸‚", "å²©å‡ºå¸‚"],
  "é³¥å–çœŒ": ["é³¥å–å¸‚", "ç±³å­å¸‚", "å€‰å‰å¸‚", "å¢ƒæ¸¯å¸‚"],
  "å³¶æ ¹çœŒ": ["æ¾æ±Ÿå¸‚", "æµœç”°å¸‚", "å‡ºé›²å¸‚", "ç›Šç”°å¸‚", "å¤§ç”°å¸‚", "å®‰æ¥å¸‚", "æ±Ÿæ´¥å¸‚", "é›²å—å¸‚"],
  "å²¡å±±çœŒ": ["å²¡å±±å¸‚", "å€‰æ•·å¸‚", "æ´¥å±±å¸‚", "ç‰é‡å¸‚", "ç¬ å²¡å¸‚", "äº•åŸå¸‚", "ç·ç¤¾å¸‚", "é«˜æ¢å¸‚", "æ–°è¦‹å¸‚", "å‚™å‰å¸‚", "ç€¬æˆ¸å†…å¸‚", "èµ¤ç£å¸‚", "çœŸåº­å¸‚", "ç¾ä½œå¸‚", "æµ…å£å¸‚"],
  "åºƒå³¶çœŒ": ["åºƒå³¶å¸‚", "å‘‰å¸‚", "ç«¹åŸå¸‚", "ä¸‰åŸå¸‚", "å°¾é“å¸‚", "ç¦å±±å¸‚", "åºœä¸­å¸‚", "ä¸‰æ¬¡å¸‚", "åº„åŸå¸‚", "å¤§ç«¹å¸‚", "æ±åºƒå³¶å¸‚", "å»¿æ—¥å¸‚å¸‚", "å®‰èŠ¸é«˜ç”°å¸‚", "æ±Ÿç”°å³¶å¸‚"],
  "å±±å£çœŒ": ["ä¸‹é–¢å¸‚", "å®‡éƒ¨å¸‚", "å±±å£å¸‚", "è©å¸‚", "é˜²åºœå¸‚", "ä¸‹æ¾å¸‚", "å²©å›½å¸‚", "å…‰å¸‚", "é•·é–€å¸‚", "æŸ³äº•å¸‚", "ç¾ç¥¢å¸‚", "å‘¨å—å¸‚", "å±±é™½å°é‡ç”°å¸‚"],
  "å¾³å³¶çœŒ": ["å¾³å³¶å¸‚", "é³´é–€å¸‚", "å°æ¾å³¶å¸‚", "é˜¿å—å¸‚", "å‰é‡å·å¸‚", "é˜¿æ³¢å¸‚", "ç¾é¦¬å¸‚", "ä¸‰å¥½å¸‚"],
  "é¦™å·çœŒ": ["é«˜æ¾å¸‚", "ä¸¸äº€å¸‚", "å‚å‡ºå¸‚", "å–„é€šå¯ºå¸‚", "è¦³éŸ³å¯ºå¸‚", "ã•ã¬ãå¸‚", "æ±ã‹ãŒã‚å¸‚", "ä¸‰è±Šå¸‚"],
  "æ„›åª›çœŒ": ["æ¾å±±å¸‚", "ä»Šæ²»å¸‚", "å®‡å’Œå³¶å¸‚", "å…«å¹¡æµœå¸‚", "æ–°å±…æµœå¸‚", "è¥¿æ¡å¸‚", "å¤§æ´²å¸‚", "ä¼Šäºˆå¸‚", "å››å›½ä¸­å¤®å¸‚", "è¥¿äºˆå¸‚", "æ±æ¸©å¸‚"],
  "é«˜çŸ¥çœŒ": ["é«˜çŸ¥å¸‚", "å®¤æˆ¸å¸‚", "å®‰èŠ¸å¸‚", "å—å›½å¸‚", "åœŸä½å¸‚", "é ˆå´å¸‚", "å®¿æ¯›å¸‚", "åœŸä½æ¸…æ°´å¸‚", "å››ä¸‡åå¸‚", "é¦™å—å¸‚", "é¦™ç¾å¸‚"],
  "ç¦å²¡çœŒ": ["åŒ—ä¹å·å¸‚", "ç¦å²¡å¸‚", "å¤§ç‰Ÿç”°å¸‚", "ä¹…ç•™ç±³å¸‚", "ç›´æ–¹å¸‚", "é£¯å¡šå¸‚", "ç”°å·å¸‚", "æŸ³å·å¸‚", "å…«å¥³å¸‚", "ç­‘å¾Œå¸‚", "å¤§å·å¸‚", "è¡Œæ©‹å¸‚", "è±Šå‰å¸‚", "ä¸­é–“å¸‚", "å°éƒ¡å¸‚", "ç­‘ç´«é‡å¸‚", "æ˜¥æ—¥å¸‚", "å¤§é‡åŸå¸‚", "å®—åƒå¸‚", "å¤ªå®°åºœå¸‚", "å¤è³€å¸‚", "ç¦æ´¥å¸‚", "ã†ãã¯å¸‚", "å®®è‹¥å¸‚", "å˜‰éº»å¸‚", "æœå€‰å¸‚", "ã¿ã‚„ã¾å¸‚", "ç³¸å³¶å¸‚", "é‚£ç‚å·å¸‚"],
  "ä½è³€çœŒ": ["ä½è³€å¸‚", "å”æ´¥å¸‚", "é³¥æ –å¸‚", "å¤šä¹…å¸‚", "ä¼Šä¸‡é‡Œå¸‚", "æ­¦é›„å¸‚", "é¹¿å³¶å¸‚", "å°åŸå¸‚", "å¬‰é‡å¸‚", "ç¥åŸ¼å¸‚"],
  "é•·å´çœŒ": ["é•·å´å¸‚", "ä½ä¸–ä¿å¸‚", "å³¶åŸå¸‚", "è««æ—©å¸‚", "å¤§æ‘å¸‚", "å¹³æˆ¸å¸‚", "æ¾æµ¦å¸‚", "å¯¾é¦¬å¸‚", "å£±å²å¸‚", "äº”å³¶å¸‚", "è¥¿æµ·å¸‚", "é›²ä»™å¸‚", "å—å³¶åŸå¸‚"],
  "ç†Šæœ¬çœŒ": ["ç†Šæœ¬å¸‚", "å…«ä»£å¸‚", "äººå‰å¸‚", "è’å°¾å¸‚", "æ°´ä¿£å¸‚", "ç‰åå¸‚", "å±±é¹¿å¸‚", "èŠæ± å¸‚", "å®‡åœŸå¸‚", "ä¸Šå¤©è‰å¸‚", "å®‡åŸå¸‚", "é˜¿è˜‡å¸‚", "å¤©è‰å¸‚", "åˆå¿—å¸‚"],
  "å¤§åˆ†çœŒ": ["å¤§åˆ†å¸‚", "åˆ¥åºœå¸‚", "ä¸­æ´¥å¸‚", "æ—¥ç”°å¸‚", "ä½ä¼¯å¸‚", "è‡¼æµå¸‚", "æ´¥ä¹…è¦‹å¸‚", "ç«¹ç”°å¸‚", "è±Šå¾Œé«˜ç”°å¸‚", "æµç¯‰å¸‚", "å®‡ä½å¸‚", "è±Šå¾Œå¤§é‡å¸‚", "ç”±å¸ƒå¸‚", "å›½æ±å¸‚"],
  "å®®å´çœŒ": ["å®®å´å¸‚", "éƒ½åŸå¸‚", "å»¶å²¡å¸‚", "æ—¥å—å¸‚", "å°æ—å¸‚", "æ—¥å‘å¸‚", "ä¸²é–“å¸‚", "è¥¿éƒ½å¸‚", "ãˆã³ã®å¸‚"],
  "é¹¿å…å³¶çœŒ": ["é¹¿å…å³¶å¸‚", "é¹¿å±‹å¸‚", "æ•å´å¸‚", "é˜¿ä¹…æ ¹å¸‚", "å‡ºæ°´å¸‚", "æŒ‡å®¿å¸‚", "è¥¿ä¹‹è¡¨å¸‚", "å‚æ°´å¸‚", "è–©æ‘©å·å†…å¸‚", "æ—¥ç½®å¸‚", "æ›½æ–¼å¸‚", "éœ§å³¶å¸‚", "ã„ã¡ãä¸²æœ¨é‡å¸‚", "å—ã•ã¤ã¾å¸‚", "å¿—å¸ƒå¿—å¸‚", "å¥„ç¾å¸‚", "å—ä¹å·å¸‚", "ä¼Šä½å¸‚", "å§¶è‰¯å¸‚"],
  "æ²–ç¸„çœŒ": ["é‚£è¦‡å¸‚", "å®œé‡æ¹¾å¸‚", "çŸ³å£å¸‚", "æµ¦æ·»å¸‚", "åè­·å¸‚", "ç³¸æº€å¸‚", "æ²–ç¸„å¸‚", "è±Šè¦‹åŸå¸‚", "ã†ã‚‹ã¾å¸‚", "å®®å¤å³¶å¸‚", "å—åŸå¸‚"]
};


================================================================================
FILE: src/lib/utils.ts
================================================================================

import { clsx, type ClassValue } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}


